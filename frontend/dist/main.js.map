{"version":3,"file":"main.js","mappings":";;;;;;;;;;;;;;;;AACuD;AAIc;;;AAErE,MAAM,MAAM,GAAW;IACrB,8CAA8C;IAC9C,kDAAkD;IAClD,qDAAqD;IACrD,EAAE,IAAI,EAAE,EAAE,EAAE,YAAY,EAAE,GAAG,EAAE,CAAC,8EAAmB,EAAE;CACtD,CAAC;AAMK,MAAM,gBAAgB;;gFAAhB,gBAAgB;6GAAhB,gBAAgB;iHAHjB,iEAAoB,CAAC,MAAM,CAAC,EAC5B,yDAAY;mIAEX,gBAAgB,oFAFjB,yDAAY;;;;;;;;;;;;;;;;;;;ACTjB,MAAM,YAAY;IALzB;QAME,UAAK,GAAG,cAAc,CAAC;KACxB;;wEAFY,YAAY;0GAAZ,YAAY;QAHZ,2EAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHsB;AACV;AACE;AAEF;AACT;AAC2B;AACA;AACiB;AACT;AACA;AACY;AACN;AACR;AAC1B;;AAyB/C,MAAM,SAAS;;kEAAT,SAAS;uGAAT,SAAS,cAFR,wDAAY;2GARtB,qEAAa;QACb,iEAAgB;QAChB,wDAAW;QACX,gEAAmB;QACnB,mEAAgB;QAChB,gEAAY;oIAKH,SAAS,mBArBlB,wDAAY;QACZ,mFAAiB;QACjB,mFAAiB;QACjB,oGAAqB;QACrB,2FAAkB;QAClB,2FAAkB;QAClB,uGAAsB;QACtB,iGAAoB;QACpB,yFAAmB,aAGnB,qEAAa;QACb,iEAAgB;QAChB,wDAAW;QACX,gEAAmB;QACnB,mEAAgB;QAChB,gEAAY;mEAdZ,mFAAiB,GACjB,oGAAqB;IACrB,2FAAkB;IAElB,uGAAsB;;;;;;;;;;;;;;;;;;;ACxB1B;;;;;;;ICAEC,4DAAAA,UAAuC,CAAvC,EAAuC,KAAvC,EAAuC,CAAvC,EAAuC,IAAvC,EAAuC,CAAvC;IAEoCA,oDAAAA;IAAYA,0DAAAA;IAC5CA,4DAAAA;IAAGA,oDAAAA;IAAYA,0DAAAA;;;;;IADiBA,uDAAAA;IAAAA,+DAAAA;IAC7BA,uDAAAA;IAAAA,+DAAAA;;;;ADKH,MAAOC,sBAAP,CAA6B;EAIjCC,YAAoBC,aAApB,EAAmD;IAA/B;IAFpB,gBAAW,IAAIJ,iDAAJ,CAA+B,EAA/B,CAAX;EAEwD;;EAExDK,QAAQ;IACN,KAAKD,aAAL,CAAmBE,eAAnB,GAAqCC,SAArC,CAA+C;MAC7CC,IAAI,EAAGC,GAAD,IAAQ;QACZC,OAAO,CAACC,IAAR,CAAaF,GAAb,EADY,CAEZ;QACA;QACA;QACA;MACD;IAP4C,CAA/C;EASD;;AAhBgC;;;mBAAtBP,wBAAsBD,+DAAAA,CAAAA,gFAAAA;AAAA;;;QAAtBC;EAAsBU;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCTnCf,4DAAAA;MACEA,wDAAAA;;MAMFA,0DAAAA;;;;MANsBA,uDAAAA;MAAAA,wDAAAA,YAAAA,yDAAAA;;;;;;;;;;;;;;;;;;;;ACD0D;;;AAOzE,MAAM,kBAAkB;IAS7B;QAPS,UAAK,GAAW,CAAC,CAAC;QAKlB,WAAM,GAAuB,IAAI,CAAC;IAE3B,CAAC;IAEjB,QAAQ,KAAW,CAAC;IAEpB,aAAa,CAAC,IAAS;QACrB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,OAAO,CAAC,IAAI,CAAC,iCAAiC,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;QACzD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,KAAoB,EAAE,EAAE;YAChD,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAE,KAAK,CAAC,CAAC;YACtC,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,SAAS,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC5D,CAAC,CAAC;IACJ,CAAC;;oFApBU,kBAAkB;gHAAlB,kBAAkB;;;;;;QCP/B,yEAA2E;QAEpC,uDAAW;QAAA,4DAAO;QAEvD,yEAAiE;QACnE,4DAAM;;QAHiC,0DAAW;QAAX,4EAAW;QAE9B,0DAAoB;QAApB,iFAAoB;;;;;;;;;;;;;;;;;;;;;ACHD;;;;;;ICArC,wEAA6D;IAC3D,+EAAgE;IAClE,qEAAe;;;;IADG,0DAAkB;IAAlB,8EAAkB;;ADQ/B,MAAM,kBAAkB;IAM7B,YAAoB,WAA+B;QAA/B,gBAAW,GAAX,WAAW,CAAoB;QAJnD,UAAK,GAAG,IAAI,iDAAe,CAAQ,EAAE,CAAC,CAAC;IAIgB,CAAC;IAExD,QAAQ;IACR,CAAC;;oFATU,kBAAkB;gHAAlB,kBAAkB;QCV/B,yEAA4D;QAC1D,gIAEe;QACjB,4DAAM;;QAH2B,0DAAe;QAAf,oFAAe;;;;;;;;;;;;;;;;;;ACD+C;AACxD;;;;AAOhC,MAAM,qBAAqB;IAgBhC;QAdS,aAAQ,GAAG,kBAAkB,CAAC;QAC9B,iBAAY,GAAwC,IAAI,iDAAe,CAAqB,IAAI,CAAC,CAAC;QAK3G,eAAU,GAAG;YACX,CAAC,EAAE,CAAC;YACJ,CAAC,EAAE,CAAC;SACL,CAAC;QAEF,iBAAY,GAAG,KAAK,CAAC;QACrB,iBAAY,GAAG,IAAI,CAAC;IAEJ,CAAC;IAEjB,QAAQ;IACR,CAAC;IAED,eAAe;QACb,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,WAAW,GAAG,CAAC,KAAK,EAAE,EAAE;YACnD,KAAK,CAAC,wBAAwB,EAAE,CAAC;YACjC,IAAI,CAAC,UAAU,CAAC,CAAC,GAAG,KAAK,CAAC,OAAO,CAAC;YAClC,IAAI,CAAC,UAAU,CAAC,CAAC,GAAG,KAAK,CAAC,OAAO,CAAC;YAClC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;QACrC,CAAC,CAAC;QACF,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,SAAS,GAAG,CAAC,KAAK,EAAE,EAAE;YACjD,KAAK,CAAC,wBAAwB,EAAE,CAAC;YACjC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC;QACpC,CAAC,CAAC;QACF,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,KAAK,EAAE,EAAE;YAC9C,KAAK,CAAC,wBAAwB,EAAE,CAAC;YACjC,KAAK,CAAC,cAAc,EAAE,CAAC;YACvB,IAAI,KAAK,CAAC,OAAO,IAAI,CAAC,IAAI,KAAK,CAAC,OAAO,IAAI,CAAC,EAAE;gBAAE,OAAO;aAAE;YACzD,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC;YAClF,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG,MAAM,CAAC,UAAU,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC;QAC1G,CAAC,CAAC;QACF,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;YAC1B,IAAI,EAAE,CAAC,MAAM,EAAE,EAAE;gBACf,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,GAAG,MAAM,CAAC;gBAE9C,IAAI,CAAC,aAAa,EAAE,CAAC;gBACrB,IAAI,CAAC,aAAa,EAAE,CAAC;YACvB,CAAC;SACF,CAAC,CAAC;IACL,CAAC;IAED,aAAa;QACX,MAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QAC5C,WAAW,EAAE,cAAc,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YAC5C,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC;QACpC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,aAAa;QACX,MAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QAC5C,WAAW,EAAE,cAAc,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YAC5C,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC;QACpC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,WAAW,CAAC,KAAY;QACtB,IAAI,CAAC,YAAY,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC;QACvC,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAED,WAAW,CAAC,KAAY;QACtB,IAAI,CAAC,YAAY,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC;QACvC,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;;0FAvEU,qBAAqB;mHAArB,qBAAqB;;;;;;;;QCRlC,4EAC8E;QAE1E,yEAA8E;QAC9E,yEAAmC;QACC,uDAAY;QAAA,4DAAO;QAEvD,yEAA6E;QACnE,mJAAS,uBAAmB,IAAC;QAEnC,8DACkB;QADlB,0EACkB;QAChB,uEAC2M;QAC3M,+DACF;QAAA,4DAAM;QAER,+DACkK;QADlK,6EACkK;QAD1J,oJAAS,uBAAmB,IAAC;QAEnC,8DACkB;QADlB,0EACkB;QAChB,uEAC4I;QAC9I,4DAAM;;QApBM,0DAAiB;QAAjB,0EAAiB;QAEG,0DAAY;QAAZ,6EAAY;QAI5C,0DAA+J;QAA/J,qOAA+J;QAS/J,0DAA+J;QAA/J,qOAA+J;;;;;;;;;;;;;;;;;;ACXhK,MAAM,oBAAoB;IAE/B,gBAAgB,CAAC;IAEjB,QAAQ;IACR,CAAC;;wFALU,oBAAoB;kHAApB,oBAAoB;QCPjC,oEAAG;QAAA,8EAAmB;QAAA,4DAAI;;;;;;;;;;;;;;;;;;;;ACC+C;AACL;;;;;;;AAQ7D,MAAM,iBAAiB;IAQ5B,YAAoB,WAAwB,EAAU,IAAgB,EAAU,MAAc;QAA1E,gBAAW,GAAX,WAAW,CAAa;QAAU,SAAI,GAAJ,IAAI,CAAY;QAAU,WAAM,GAAN,MAAM,CAAQ;QAC5F,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YAC3C,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC,+DAAmB,CAAC,CAAC;YACvC,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC,+DAAmB,CAAC,CAAC;SACxC,CAAC,CAAC;QACH,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YACzC,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC,+DAAmB,CAAC,CAAC;YACvC,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC,+DAAmB,CAAC,CAAC;SACxC,CAAC,CAAC;IACL,CAAC;IAED,QAAQ;IACR,CAAC;IAED,YAAY,CAAC,KAAY;QACvB,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QACjC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAED,aAAa,CAAC,KAAY;QACxB,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QACjC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAED,gBAAgB;QACd,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QACnE,MAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAChC,QAAQ,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC;QACnE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE,QAAQ,CAAC,CAAC,SAAS,CAAC;YACxD,IAAI,EAAE,CAAC,IAAS,EAAE,EAAE;gBAClB,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrB,CAAC;YACD,KAAK,EAAE,CAAC,GAAQ,EAAE,EAAE;gBAClB,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACrB,CAAC;SACF,CAAC;IACJ,CAAC;IAED,UAAU,CAAC,KAAY;QACrB,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QACjC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IACzD,CAAC;IAED,WAAW,CAAC,KAAY;QACtB,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QACjC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IACzD,CAAC;IAED,cAAc;QACZ,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAC/D,MAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAChC,QAAQ,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;QACjE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,QAAQ,CAAC,CAAC,SAAS,CAAC;YACtD,IAAI,EAAE,CAAC,IAAS,EAAE,EAAE;gBAClB,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrB,CAAC;YACD,KAAK,EAAE,CAAC,GAAQ,EAAE,EAAE;gBAClB,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACrB,CAAC;SACF,CAAC;IACJ,CAAC;IAED,cAAc,CAAC,QAAgB;QAC7B,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;QAClD,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;IACtC,CAAC;IAED,eAAe,CAAC,KAAY;QAC1B,KAAK,CAAC,wBAAwB,EAAE,CAAC;IACnC,CAAC;;kFAjFU,iBAAiB;+GAAjB,iBAAiB;;;;;;;;QCV9B,yEAAqD;QAEjB,uEAAY;QAAA,4DAAK;QAEnD,yEAAuC;QAIC,iFAAsB;QAAA,4DAAO;QAC7D,2EAAgD;QAAA,+EAAmB;QAAA,4DAAO;QAE5E,wEAAkC;QAChC,kMAEF;QAAA,4DAAI;QACJ,2EAAmD;QACzC,gJAAS,wBAAoB,IAAC;QAEpC,yEACF;QAAA,4DAAS;QACT,8EACsJ;QAD9I,gJAAS,sBAAkB,IAAC;QAElC,uEACF;QAAA,4DAAS;QAIf,qEACM;QACR,4DAAM;QAEN,+EAA+F;QAA9E,6IAAS,yBAAqB,IAAC;QAC9C,2EAA2G;QAAtG,6IAAS,2BAAuB,IAAC;QACpC,2EAAsE;QACtC,uEAAW;QAAA,4DAAK;QAC9C,qEAA2C;QAC3C,4EAA6F;QAA1D,0IAAU,sBAAkB,IAAC;QAC9D,wEAEmN;QAMnN,8EACwO;QACtO,mFACF;QAAA,4DAAS;QAOjB,+EAA2F;QAA5E,6IAAS,uBAAmB,IAAC;QAC1C,2EAA2G;QAAtG,6IAAS,2BAAuB,IAAC;QACpC,2EAAsE;QACtC,qEAAS;QAAA,4DAAK;QAC5C,qEAA2C;QAC3C,4EAAyF;QAAxD,0IAAU,oBAAgB,IAAC;QAC1D,wEAEmN;QAMnN,8EACwO;QACtO,gFACF;QAAA,4DAAS;;QApCL,2DAA4B;QAA5B,yFAA4B;QAwB5B,2DAA0B;QAA1B,uFAA0B;;;;;;;;;;;;;;;;;;;;;;AC1DxC;;;;AAcM,MAAOgB,iBAAP,CAAwB;EA2B5Bd,YAAoBe,WAApB,EAA6Dd,aAA7D,EAA4F;IAAxE;IAAyC;IAzB7D,eAAU,CACR,8BADQ,EAER,+BAFQ,EAGR,+BAHQ,EAIR,+BAJQ,EAKR,+BALQ,EAMR,qBANQ,EAOR,uBAPQ,EAQR,qBARQ,EASR,yBATQ,EAUR,sBAVQ,EAWR,qBAXQ,EAYR,wBAZQ,EAaR,0BAbQ,EAcR,0BAdQ,EAeR,yBAfQ,CAAV;IAkBA,gBAA0B,IAA1B;IACA,gBAA0B,IAA1B;IACA,kBAAkD,IAAIJ,iDAAJ,CAAwC,IAAxC,CAAlD;IAEA,eAAwB,EAAxB;IAIE,KAAKmB,QAAL,GAAgBC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,CAAhB;IACA,KAAKC,QAAL,GAAgBH,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,CAAhB;EACD;;EAEDjB,QAAQ;IACN,KAAKmB,YAAL;EACD;;EAEKA,YAAY;IAAA;;IAAA;MAChB,IAAIC,WAAW,SAASC,SAAS,CAACC,YAAV,CAAuBH,YAAvB,CAAoC;QAC1DI,KAAK,EAAE,IADmD;QAE1DC,KAAK,EAAE;UACLC,KAAK,EAAE;YAAEC,GAAG,EAAE,GAAP;YAAYC,KAAK,EAAE,GAAnB;YAAwBC,GAAG,EAAE;UAA7B,CADF;UAELC,MAAM,EAAE;YAAEH,GAAG,EAAE,GAAP;YAAYC,KAAK,EAAE,GAAnB;YAAwBC,GAAG,EAAE;UAA7B;QAFH;MAFmD,CAApC,CAAxB;;MAOA,KAAI,CAACE,UAAL,CAAgB3B,IAAhB,CAAqBiB,WAArB;;MACA,KAAI,CAACrB,aAAL,CAAmBE,eAAnB,GAAqCC,SAArC,CAA+C;QAC7CC,IAAI,EAAGC,GAAD,IAAQ;UACZC,OAAO,CAAC0B,GAAR,CAAY3B,GAAZ;;UACA,QAAQA,GAAG,CAAC4B,IAAZ;YACE,KAAK,OAAL;cACE,KAAI,CAACnB,WAAL,CAAiBoB,kBAAjB,CAAoC,KAAI,CAACC,OAAL,CAAa,CAAb,EAAgBC,IAApD,EAA0D/B,GAAG,CAACgC,IAA9D;;cACA;;YACF,KAAK,QAAL;cACE,KAAI,CAACF,OAAL,CAAa,CAAb,EAAgBC,IAAhB,CAAqBE,oBAArB,CAA0CjC,GAAG,CAACgC,IAA9C,EAAoDE,IAApD,CAAyD,MAAK;gBAC5D,KAAI,CAACR,UAAL,CAAgBS,KAAhB,EAAuBC,SAAvB,GAAmCC,OAAnC,CAA2CC,KAAK,IAAG;kBACjD,KAAI,CAACR,OAAL,CAAa,CAAb,EAAgBC,IAAhB,CAAqBQ,QAArB,CAA8BD,KAA9B;gBACD,CAFD;cAGD,CAJD;;cAKA;;YACF,KAAK,WAAL;cACE,IAAItC,GAAG,CAACgC,IAAJ,IAAY,IAAhB,EAAsB;gBACpB,IAAIQ,SAAS,GAAG,IAAIC,eAAJ,CAAoBzC,GAAG,CAACgC,IAAxB,CAAhB;;gBACA,KAAI,CAACF,OAAL,CAAa,CAAb,EAAgBC,IAAhB,CAAqBW,eAArB,CAAqCF,SAArC;cACD;;cACD;;YACF,KAAK,MAAL;cACE;UAlBJ;QAoBD;MAvB4C,CAA/C;;MAyBA,IAAIT,IAAI,SAAS,KAAI,CAACtB,WAAL,CAAiBkC,iBAAjB,CAAmC3B,WAAnC,CAAjB;;MACA,KAAI,CAACc,OAAL,CAAac,IAAb,CAAkB;QAAEC,EAAE,EAAE,KAAI,CAAC/B,QAAX;QAAqBiB;MAArB,CAAlB;IAnCgB;EAoCjB;;AAxE2B;;;mBAAjBvB,mBAAiBhB,+DAAAA,CAAAA,qFAAAA,GAAAA,+DAAAA,CAAAA,gFAAAA;AAAA;;;QAAjBgB;EAAiBL;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MChB9Bf,4DAAAA,cAAqD,CAArD,EAAqD,KAArD,EAAqD,CAArD,EAAqD,CAArD,EAAqD,IAArD,EAAqD,CAArD;MAEoCA,oDAAAA;MAAwCA,0DAAAA;MACxEA,uDAAAA;MAGFA,0DAAAA;MACAA,uDAAAA,4BAAmE,CAAnE,EAAmE,gBAAnE,EAAmE,CAAnE,EAAmE,CAAnE,EAAmE,oBAAnE;MAGFA,0DAAAA;;;;MARoCA,uDAAAA;MAAAA,gEAAAA;MAKfA,uDAAAA;MAAAA,wDAAAA;MACHA,uDAAAA;MAAAA,wDAAAA;;;;;;;;;;;;;;;;;;;;;;;ACRlB;;;;;;AASM,MAAOuD,mBAAP,CAA0B;EAQ9BrD,YAAoBsD,cAApB,EAAgEC,MAAhE,EAAwF;IAApE;IAA4C;EAA6B;;EAE7FrD,QAAQ;IACN,IAAI,KAAKsD,UAAL,IAAmBC,SAAvB,EAAkC;MAChC,KAAKD,UAAL,GAAkB,KAAKF,cAAL,CAAoBI,mBAApB,EAAlB;IACD;;IACD,KAAKH,MAAL,CAAYpD,eAAZ,GAA8BC,SAA9B,CAAwC;MACtCC,IAAI,EAAGC,GAAD,IAAQ;QACZ,QAAQA,GAAG,CAAC4B,IAAZ;UACE,KAAK,OAAL;YACE,KAAKsB,UAAL,CAAgBG,OAAhB,GAA2BC,CAAD,IAAqB;cAC7C,KAAKC,WAAL,CAAiBC,aAAjB,CAA+BC,SAA/B,GAA2CH,CAAC,CAACI,OAAF,CAAU,CAAV,CAA3C;YACD,CAFD;;YAGA,KAAKC,WAAL,CAAiBvB,SAAjB,GAA6BC,OAA7B,CAAqCC,KAAK,IAAG;cAC3C,KAAKY,UAAL,CAAgBX,QAAhB,CAAyBD,KAAzB,EAAgC,KAAKqB,WAArC;YACD,CAFD;YAGA,KAAKX,cAAL,CAAoBY,YAApB,CAAiC,KAAKV,UAAtC,EAAkDlD,GAAG,CAACgC,IAAtD;YACA;;UACF,KAAK,QAAL;YACE,KAAKkB,UAAL,CAAgBjB,oBAAhB,CAAqCjC,GAAG,CAACgC,IAAzC,EAA+CE,IAA/C,CAAoD,MAAK,CACxD,CADD;YAEA;;UACF,KAAK,QAAL;YACE,KAAKyB,WAAL,CAAiBvB,SAAjB,GAA6BC,OAA7B,CAAqCC,KAAK,IAAG;cAC3C,KAAKY,UAAL,CAAgBX,QAAhB,CAAyBD,KAAzB,EAAgC,KAAKqB,WAArC;YACD,CAFD;YAGA;;UACF,KAAK,WAAL;YACE,IAAI3D,GAAG,CAACgC,IAAJ,IAAY,IAAhB,EAAsB;cACpB,IAAIQ,SAAS,GAAG,IAAIC,eAAJ,CAAoBzC,GAAG,CAACgC,IAAxB,CAAhB;cACA,KAAKkB,UAAL,CAAgBR,eAAhB,CAAgCF,SAAhC;YACD;;YACD;QAxBJ;MA0BD;IA5BqC,CAAxC;EA8BD;;EAEKqB,UAAU;IAAA;;IAAA;MACd,KAAI,CAACF,WAAL,SAAyB1C,SAAS,CAACC,YAAV,CAAuBH,YAAvB,CAAoC;QAC3DI,KAAK,EAAE,IADoD;QAC9CC,KAAK,EAAE;MADuC,CAApC,CAAzB;MAGA,KAAI,CAAC0C,UAAL,CAAgBN,aAAhB,CAA8BC,SAA9B,GAA0C,KAAI,CAACE,WAA/C;IAJc;EAKf;;EAEKI,IAAI;IAAA;;IAAA;MACR,MAAI,CAACb,UAAL,SAAwB,MAAI,CAACF,cAAL,CAAoBI,mBAApB,EAAxB;;MACA,MAAI,CAACO,WAAL,CAAiBvB,SAAjB,GAA6BC,OAA7B,CAAqCC,KAAK,IAAG;QAC3C,MAAI,CAACY,UAAL,CAAgBX,QAAhB,CAAyBD,KAAzB,EAAgC,MAAI,CAACqB,WAArC;;QACA,MAAI,CAACT,UAAL,CAAgBG,OAAhB,GAA2BC,CAAD,IAAqB;UAC7CrD,OAAO,CAAC0B,GAAR,CAAY2B,CAAC,CAACI,OAAF,CAAUM,MAAtB;UACA,MAAI,CAACT,WAAL,CAAiBC,aAAjB,CAA+BC,SAA/B,GAA2CH,CAAC,CAACI,OAAF,CAAU,CAAV,CAA3C;QACD,CAHD;MAID,CAND;;MAOA,MAAM,MAAI,CAACV,cAAL,CAAoBiB,WAApB,CAAgC,MAAI,CAACf,UAArC,CAAN;IATQ;EAUT;;EAEDgB,MAAM,IAEL;;AAnE6B;;;mBAAnBnB,qBAAmBvD,+DAAAA,CAAAA,qFAAAA,GAAAA,+DAAAA,CAAAA,gFAAAA;AAAA;;;QAAnBuD;EAAmB5C;EAAAgE;IAAA;;;;;;;;;;;;;;;;;MCThC3E,4DAAAA,cAA2B,CAA3B,EAA2B,KAA3B,EAA2B,CAA3B;MAEIA,uDAAAA;MAEFA,0DAAAA;MACAA,4DAAAA;MACEA,uDAAAA;MAEFA,0DAAAA;MAEFA,4DAAAA,cAA2B,CAA3B,EAA2B,QAA3B,EAA2B,CAA3B;MACUA,wDAAAA;QAAA,OAAS4E,gBAAT;MAAqB,CAArB;MAAgF5E,oDAAAA;MAASA,0DAAAA;MACjGA,4DAAAA;MAAQA,wDAAAA;QAAA,OAAS4E,UAAT;MAAe,CAAf;MAA0E5E,oDAAAA;MAAIA,0DAAAA;MACtFA,4DAAAA;MAAQA,wDAAAA;QAAA,OAAS4E,YAAT;MAAiB,CAAjB;MAA4E5E,oDAAAA;MAAMA,0DAAAA;;;;MAXdA,uDAAAA;MAAAA,wDAAAA,mBAAiB,UAAjB,EAAiB,IAAjB,EAAiB,OAAjB,EAAiB,IAAjB;MAICA,uDAAAA;MAAAA,wDAAAA,mBAAiB,UAAjB,EAAiB,IAAjB,EAAiB,OAAjB,EAAiB,IAAjB;;;;;;;;;;;;;;;;;;;;;;;;ACCzE,MAAO6E,kBAAP,CAAyB;EAE7B3E,YAAoBC,aAApB,EAAmD;IAA/B;EAAoC;;EAElDsE,WAAW,CAAClC,IAAD,EAAwB;IAAA;;IAAA;MACvC,IAAIuC,WAAW,SAASvC,IAAI,CAACkC,WAAL,CAAiB;QAAEM,mBAAmB,EAAE,IAAvB;QAA6BC,mBAAmB,EAAE;MAAlD,CAAjB,CAAxB;MACA,MAAMzC,IAAI,CAAC0C,mBAAL,CAAyBH,WAAzB,CAAN;;MACA,KAAI,CAAC3E,aAAL,CAAmB+E,WAAnB,CAA+B;QAAE9C,IAAI,EAAE,OAAR;QAAiBI,IAAI,EAAEsC;MAAvB,CAA/B;IAHuC;EAIxC;;EAEKV,YAAY,CAAC7B,IAAD,EAA0B4C,KAA1B,EAA0D;IAAA;;IAAA;MAC1E,MAAM5C,IAAI,CAACE,oBAAL,CAA0B,IAAI2C,qBAAJ,CAA0BD,KAA1B,CAA1B,CAAN;MACA,MAAME,MAAM,SAAS9C,IAAI,CAAC6B,YAAL,CAAkB;QAAEW,mBAAmB,EAAE,IAAvB;QAA6BC,mBAAmB,EAAE;MAAlD,CAAlB,CAArB;MACA,MAAMzC,IAAI,CAAC0C,mBAAL,CAAyBI,MAAzB,CAAN;;MACA,MAAI,CAAClF,aAAL,CAAmB+E,WAAnB,CAA+B;QAAE9C,IAAI,EAAE,QAAR;QAAkBI,IAAI,EAAED,IAAI,CAAC+C;MAA7B,CAA/B;IAJ0E;EAK3E;;EAGKjD,kBAAkB,CAACE,IAAD,EAA0BgD,SAA1B,EAA8D;IAAA;;IAAA;MACpF,MAAMhD,IAAI,CAACE,oBAAL,CAA0B8C,SAA1B,CAAN;MACA,MAAMC,IAAI,SAAoCjD,IAAI,CAAC6B,YAAL,EAA9C;MACA,MAAM7B,IAAI,CAAC0C,mBAAL,CAAyBO,IAAzB,CAAN;;MACA,MAAI,CAACrF,aAAL,CAAmB+E,WAAnB,CAA+B;QAAE9C,IAAI,EAAE,QAAR;QAAkBI,IAAI,EAAED,IAAI,CAAC+C;MAA7B,CAA/B;IAJoF;EAKrF;;EAEKnC,iBAAiB,CAACsC,MAAD,EAAoB;IAAA;;IAAA;MACzC,IAAIlD,IAAI,GAAG,MAAI,CAACqB,mBAAL,EAAX;;MACA6B,MAAM,CAAC7C,SAAP,GAAmBC,OAAnB,CAA2BC,KAAK,IAAIP,IAAI,CAACQ,QAAL,CAAcD,KAAd,EAAqB2C,MAArB,CAApC;MACA,IAAID,IAAI,SAASjD,IAAI,CAACkC,WAAL,CAAiB;QAAEM,mBAAmB,EAAE,IAAvB;QAA6BC,mBAAmB,EAAE;MAAlD,CAAjB,CAAjB;MACA,MAAMzC,IAAI,CAAC0C,mBAAL,CAAyBO,IAAzB,CAAN;;MACA,MAAI,CAACrF,aAAL,CAAmB+E,WAAnB,CAA+B;QAAE9C,IAAI,EAAE,OAAR;QAAiBI,IAAI,EAAEgD;MAAvB,CAA/B;;MACA,OAAOjD,IAAP;IANyC;EAO1C;;EAEKmD,mBAAmB,CAACnD,IAAD,EAA0BoD,UAA1B,EAAiEF,MAAjE,EAAoF;IAAA;MAC3G,MAAMlD,IAAI,CAACE,oBAAL,CAA0BkD,UAA1B,CAAN;MACAF,MAAM,CAAC7C,SAAP,GAAmBC,OAAnB,CAA2BC,KAAK,IAAG;QACjCP,IAAI,CAACQ,QAAL,CAAcD,KAAd,EAAqB2C,MAArB;MACD,CAFD;IAF2G;EAK5G;;EAED7B,mBAAmB;IACjB,IAAIrB,IAAI,GAAG,IAAIqD,iBAAJ,CAAsB;MAC/BC,UAAU,EAAE,CACV;QACEC,IAAI,EAAE,CACJ,8BADI,EAEJ,+BAFI,EAGJ,+BAHI,EAIJ,+BAJI;MADR,CADU;IADmB,CAAtB,CAAX;;IAYAvD,IAAI,CAACwD,cAAL,GAAuBC,KAAD,IAAqC;MACzDvF,OAAO,CAACC,IAAR,CAAa,mBAAb;MACA,KAAKP,aAAL,CAAmB+E,WAAnB,CAA+B;QAC7B9C,IAAI,EAAE,WADuB;QAE7BI,IAAI,EAAEwD,KAAK,CAAChD;MAFiB,CAA/B;IAID,CAND;;IAOAT,IAAI,CAAC0D,yBAAL,GAAkCD,KAAD,IAAiB;MAChD,QAAQzD,IAAI,CAAC2D,kBAAb;QACE,KAAK,QAAL;QACA,KAAK,cAAL;QACA,KAAK,QAAL;UACEzF,OAAO,CAAC0F,KAAR,CAAc,mBAAd;UACA;MALJ;IAOD,CARD;;IASA5D,IAAI,CAAC6D,sBAAL,GAA+BJ,KAAD,IAAiB;MAC7CvF,OAAO,CAACC,IAAR,CAAasF,KAAb;;MACA,QAAQzD,IAAI,CAAC8D,cAAb;QACE,KAAK,QAAL;UACE5F,OAAO,CAAC0F,KAAR,CAAc,mBAAd;UACA;MAHJ;IAKD,CAPD;;IAQA,OAAO5D,IAAP;EACD;;EAGD+D,sBAAsB,CACpBC,oBADoB,EAEpBC,uBAFoB,EAEuB;IAE3C,IAAIjE,IAAI,GAAG,IAAIqD,iBAAJ,CAAsB;MAC/BC,UAAU,EAAE,CACV;QACEC,IAAI,EAAE,CACJ,8BADI,EAEJ,+BAFI,EAGJ,+BAHI,EAIJ,+BAJI;MADR,CADU;IADmB,CAAtB,CAAX;;IAYAvD,IAAI,CAACwD,cAAL,GAAuBC,KAAD,IAAqC;MACzD,KAAK7F,aAAL,CAAmB+E,WAAnB,CAA+B;QAC7B9C,IAAI,EAAE,WADuB;QAE7BI,IAAI,EAAEwD,KAAK,CAAChD;MAFiB,CAA/B;MAIAuD,oBAAoB,CAACP,KAAD,CAApB;IACD,CAND;;IAOAzD,IAAI,CAAC0D,yBAAL,GAAkCD,KAAD,IAAiB;MAChDvF,OAAO,CAACC,IAAR,CAAasF,KAAb;;MACA,QAAQzD,IAAI,CAAC2D,kBAAb;QACE,KAAK,QAAL;QACA,KAAK,cAAL;QACA,KAAK,QAAL;UACEzF,OAAO,CAAC0F,KAAR,CAAc,mBAAd;UACA;MALJ;IAOD,CATD;;IAUA5D,IAAI,CAAC6D,sBAAL,GAA+BJ,KAAD,IAAiB;MAC7CQ,uBAAuB,CAACR,KAAD,CAAvB;;MACA,QAAQzD,IAAI,CAAC8D,cAAb;QACE,KAAK,QAAL;UACE5F,OAAO,CAAC0F,KAAR,CAAc,mBAAd;UACA;MAHJ;IAKD,CAPD;;IAQA,OAAO5D,IAAP;EACD;;AA5H4B;;;mBAAlBsC,oBAAkB7E,sDAAAA,CAAAA,gEAAAA;AAAA;;;SAAlB6E;EAAkB4B,SAAlB5B,kBAAkB;EAAA6B,YAFjB;;;;;;;;;;;;;;;;;ACJ6B;;AAUpC,MAAM,gBAAgB;IAO3B;QALQ,aAAQ,GAAG,IAAI,yCAAO,EAAO,CAAC;QAGtC,QAAG,GAAG,yBAAyB;QAG7B,IAAI,CAAC,MAAM,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACtC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,EAAE;YACxB,OAAO,CAAC,GAAG,CAAC,2BAA2B,CAAC,CAAC;QAC3C,CAAC,CAAC;QACF,IAAI,CAAC,MAAM,CAAC,SAAS,GAAG,CAAC,OAAY,EAAE,EAAE;YACvC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;QAC/C,CAAC;IACH,CAAC;IAED,WAAW,CAAC,OAAY;QACtB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC;IAC5C,CAAC;IAED,eAAe;QACb,OAAO,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC;IACtC,CAAC;;gFAvBU,gBAAgB;iHAAhB,gBAAgB,WAAhB,gBAAgB,mBAFf,MAAM;;;;;;;;;;;;;;;;;;;;ACRpB;AACA;;;;;;;;ICAI1G,qEAAAA;IACEA,4DAAAA,cAAuB,CAAvB,EAAuB,MAAvB,EAAuB,CAAvB;IAC6BA,oDAAAA;IAAeA,0DAAAA;IAC1CA,4DAAAA;IAAqDA,oDAAAA;IAAgBA,0DAAAA;IAEzEA,mEAAAA;;;;;IAH+BA,uDAAAA;IAAAA,+DAAAA;IAC0BA,uDAAAA;IAAAA,+DAAAA;;;;ADIvD,MAAO4G,gBAAP,CAAuB;EAQ3B1G,YAAoBuD,MAApB,EAAyC;IAArB;IANX,gBAAW,EAAX;IAET,mBAAsB,EAAtB;IAEA,gBAAW,IAAI1D,iDAAJ,CAA2B,EAA3B,CAAX;EAE8C;;EAE9CK,QAAQ;IACN,KAAKqD,MAAL,CAAYoD,WAAZ,GAA0BvG,SAA1B,CAAoC;MAClCC,IAAI,EAAGC,GAAD,IAAQ;QACZ,QAAQA,GAAG,CAAC4B,IAAZ;UACE,KAAKuE,iEAAL;YACE,IAAII,IAAI,GAAG,KAAKC,QAAL,CAAcrE,KAAzB;YACAoE,IAAI,CAAC3D,IAAL,CAAU5C,GAAG,CAACgC,IAAd;YACA,KAAKwE,QAAL,CAAczG,IAAd,CAAmBwG,IAAnB;QAJJ;MAOD;IATiC,CAApC;EAWD;;EAED7B,WAAW;IACT,KAAKzB,MAAL,CAAYwD,UAAZ,CAAuBN,iEAAvB,EAAoC;MAAEO,IAAI,EAAE,KAAKC,QAAb;MAAuB3G,GAAG,EAAE,KAAK4G;IAAjC,CAApC;IACA,KAAKA,WAAL,GAAmB,EAAnB;EACD;;AA3B0B;;;mBAAhBR,kBAAgB5G,+DAAAA,CAAAA,mEAAAA;AAAA;;;QAAhB4G;EAAgBjG;EAAA0G;IAAAF;EAAA;EAAAvG;EAAAC;EAAAC;EAAAC;IAAA;MCT7Bf,4DAAAA,cAAuD,CAAvD,EAAuD,KAAvD;MAEIA,wDAAAA;;MAOFA,0DAAAA;MACAA,4DAAAA,cAAkB,CAAlB,EAAkB,OAAlB,EAAkB,CAAlB;MAC8EA,wDAAAA;QAAA;MAAA;MAA5EA,0DAAAA;MAEAA,4DAAAA;MAAQA,wDAAAA;QAAA,OAAS4E,iBAAT;MAAsB,CAAtB;MACN5E,4DAAAA;MAAsBA,oDAAAA;MAAYA,0DAAAA;MAClCA,4DAAAA;MAAAA,4DAAAA;MAEEA,uDAAAA;MAEFA,0DAAAA;;;;MAjBgCA,uDAAAA;MAAAA,wDAAAA,YAAAA,yDAAAA;MAS0CA,uDAAAA;MAAAA,wDAAAA;;;;;;;;;;;;;;;;;;;;;;;;ACTV;;;;;;;;ICClE,wEAAkD;IAChD,wEAA0D;IAAvD,+bAAS,iGAA0B,KAAC;IAAmB,uDAAmD;IAAA,4DAAI;IACnH,qEAAe;;;IAD6C,0DAAmD;IAAnD,qIAAmD;;;IAHjH,yEAAsD;IACf,uDAAiB;IAAA,4DAAK;IAC3D,qIAEe;IACjB,4DAAM;;;IAJiC,0DAAiB;IAAjB,iFAAiB;IACrB,0DAAe;IAAf,oFAAe;;;;IAQ9C,wEAAuD;IACrD,wEAAwE;IAArE,iWAAS,0GAA+B,KAAC;IAA4B,uDAAU;IAAA,4DAAI;IACxF,qEAAe;;;IAD2D,0DAAU;IAAV,0EAAU;;ADHnF,MAAM,iBAAiB;IAmB5B,YAAoB,MAAqB,EAAU,IAAgB;QAA/C,WAAM,GAAN,MAAM,CAAe;QAAU,SAAI,GAAJ,IAAI,CAAY;QAjB1D,aAAQ,GAAW,EAAE,CAAC;QACtB,aAAQ,GAAW,EAAE,CAAC;QAE/B,iBAAY,GAAW,EAAE,CAAC;QAC1B,eAAU,GAAW,EAAE,CAAC;QAExB,gBAAW,GAAU,EAAE,CAAC;QACxB,kBAAa,GAAU,EAAE,CAAC;QAG1B,UAAK,GAAU,EAAE,CAAC;QAElB,cAAS,GAAQ;YACf,QAAQ,EAAE,EAAE;YACZ,OAAO,EAAE,EAAE;SACZ,CAAC;IAEqE,CAAC;IAExE,QAAQ;QAEN,IAAI,CAAC,YAAY,EAAE,CAAC;QAEpB,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,SAAS,CAAC;YAClC,IAAI,EAAE,CAAC,GAAG,EAAE,EAAE;gBACZ,QAAQ,GAAG,CAAC,IAAI,EAAE;oBAChB,KAAK,sEAAgB;wBACnB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;wBAC1B,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;wBAClB,MAAM;oBACR,KAAK,yEAAmB;wBACtB,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;wBAClB,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;wBAC3B,MAAM;oBACR,KAAK,uEAAiB;wBACpB,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;wBAClB,MAAM;iBACT;YAEH,CAAC;SACF,CAAC,CAAC;IACL,CAAC;IAED,YAAY;QACV,MAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAChC,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC3C,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC,SAAS,CAAC;YACjD,IAAI,EAAE,CAAC,IAAS,EAAE,EAAE;gBAClB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;YACpB,CAAC;SACF,CAAC;IACJ,CAAC;IAED,kBAAkB;QAChB,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC;QAC5C,yIAAyI;IAC3I,CAAC;IAED,aAAa;QACX,IAAI,IAAI,CAAC,UAAU,IAAI,EAAE,EAAE;YACzB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC7C,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;SACtB;QACD,gDAAgD;IAClD,CAAC;IAED,QAAQ;QACN,MAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAChC,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC3C,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC3C,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;QACrD,KAAK,IAAI,MAAM,IAAI,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE;YACzC,QAAQ,CAAC,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;SACnC;QACD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,QAAQ,CAAC,CAAC,SAAS,CAAC;YACpD,IAAI,EAAE,CAAC,IAAS,EAAE,EAAE;gBAClB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACtB,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,sEAAgB,EAAE,IAAI,CAAC,CAAC;YACjD,CAAC;SACF,CAAC,CAAC;IAEL,CAAC;IAED,YAAY,CAAC,IAAS,EAAE,MAAW;QACjC,MAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAChC,QAAQ,CAAC,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;QACrC,QAAQ,CAAC,MAAM,CAAC,WAAW,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC5C,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAC,SAAS,CAAC;YACrD,IAAI,EAAE,CAAC,IAAS,EAAE,EAAE;gBAClB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;gBACvB,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,yEAAmB,EAAE,IAAI,CAAC,CAAC;YACpD,CAAC;SACF,CAAC;IACJ,CAAC;IAED,WAAW,CAAC,IAAS;QACnB,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC;QACzD,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,GAAQ,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC;QACpE,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QAC1B,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC3B,CAAC;;kFAtGU,iBAAiB;+GAAjB,iBAAiB;QCT9B,yEAAoD;QAClD,6GAKM;QAEN,yEAA2B;QACY,uDAAsB;QAAA,4DAAK;QAChE,yEAAsC;QACpC,+HAEe;QACf,yEAAwB;QACoD,yLAAwB;QAAlG,4DACsM;QACtM,4EAA2G;QAAnG,yIAAS,mBAAe,IAAC;QAC/B,2EAAsB;QAAA,wEAAY;QAAA,4DAAO;QACzC,8DACwC;QADxC,2EACwC;QACtC,uEACoG;QACtG,4DAAM;QAOd,+DAAwB;QAAxB,0EAAwB;QACsD,4LAA0B;QAAtG,4DACsM;QACtM,6EAAgH;QAAxG,0IAAS,wBAAoB,IAAC;QACpC,2EAAsB;QAAA,wEAAY;QAAA,4DAAO;QACzC,8DACkB;QADlB,2EACkB;QAChB,uEACoG;QACtG,4DAAM;QAIV,+DAAiB;QAAjB,2EAAiB;QACP,0IAAS,cAAU,IAAC;QAC1B,yEACF;QAAA,4DAAS;;QA7CW,0DAAQ;QAAR,8EAAQ;QAQS,0DAAsB;QAAtB,uFAAsB;QAExB,0DAAoB;QAApB,0FAAoB;QAIuB,0DAAwB;QAAxB,mFAAwB;QAgB1B,0DAA0B;QAA1B,qFAA0B;;;;;;;;;;;;;;;;;;;;AC/B1G;AACA;;;;AAOM,MAAOsH,kBAAP,CAAyB;EAgB7BpH;IAdS,gBAAW,kBAAX;IACA,cAA8C,IAAIH,iDAAJ,CAAwC,IAAxC,CAA9C;IAKT,kBAAa;MACXwH,CAAC,EAAE,CADQ;MAEXC,CAAC,EAAE;IAFQ,CAAb;IAKA,oBAAe,IAAf;IACA,oBAAe,IAAf;EAEiB;;EAEjBpH,QAAQ,IACP;;EAEDqH,eAAe;IACb,KAAKC,SAAL,CAAe1D,aAAf,CAA6B2D,WAA7B,GAA4C3B,KAAD,IAAU;MACnDA,KAAK,CAAC4B,wBAAN;MACA,KAAKC,UAAL,CAAgBN,CAAhB,GAAoBvB,KAAK,CAAC8B,OAA1B;MACA,KAAKD,UAAL,CAAgBL,CAAhB,GAAoBxB,KAAK,CAAC+B,OAA1B;MACA,KAAKC,OAAL,CAAahE,aAAb,CAA2BiE,KAA3B;IACD,CALD;;IAMA,KAAKP,SAAL,CAAe1D,aAAf,CAA6BkE,SAA7B,GAA0ClC,KAAD,IAAU;MACjDA,KAAK,CAAC4B,wBAAN;MACA,KAAKI,OAAL,CAAahE,aAAb,CAA2BmE,IAA3B;IACD,CAHD;;IAIA,KAAKT,SAAL,CAAe1D,aAAf,CAA6BoE,MAA7B,GAAuCpC,KAAD,IAAU;MAC9CA,KAAK,CAAC4B,wBAAN;MACA5B,KAAK,CAACqC,cAAN;;MACA,IAAIrC,KAAK,CAACsC,OAAN,IAAiB,CAAjB,IAAsBtC,KAAK,CAACuC,OAAN,IAAiB,CAA3C,EAA8C;QAAE;MAAS;;MACzD,KAAKb,SAAL,CAAe1D,aAAf,CAA6BwE,KAA7B,CAAmCC,GAAnC,GAAyC,GAAGzC,KAAK,CAAC0C,OAAN,GAAgB,KAAKb,UAAL,CAAgBL,CAAC,IAA7E;MACA,KAAKE,SAAL,CAAe1D,aAAf,CAA6BwE,KAA7B,CAAmCG,KAAnC,GAA2C,GAAGxH,MAAM,CAACyH,UAAP,GAAoB5C,KAAK,CAAC6C,OAA1B,GAAoC,KAAKhB,UAAL,CAAgBN,CAAC,IAAnG;IACD,CAND;;IAOA,KAAKuB,MAAL,CAAYxI,SAAZ,CAAsB;MACpBC,IAAI,EAAGkF,MAAD,IAAW;QACf,IAAIA,MAAM,IAAI,IAAd,EAAoB;UAClB;QACD;;QACD,KAAKuC,OAAL,CAAahE,aAAb,CAA2BC,SAA3B,GAAuCwB,MAAvC;QAEA,KAAKsD,aAAL;QACA,KAAKC,aAAL;MACD;IATmB,CAAtB;EAWD;;EAEKD,aAAa;IAAA;;IAAA;MACjB,IAAI,KAAI,CAACD,MAAL,CAAYnG,KAAZ,IAAqB,IAAzB,EAA+B;QAC7B;MACD;;MACD,MAAMnB,WAAW,GAAG,KAAI,CAACsH,MAAL,CAAYnG,KAAhC;MACAnB,WAAW,EAAEyH,cAAb,GAA8BpG,OAA9B,CAAsCC,KAAK,IAAG;QAC5CA,KAAK,CAACoG,OAAN,GAAgB,KAAI,CAACC,YAArB;MACD,CAFD;;MAGA,IAAI3H,WAAW,IAAIA,WAAW,CAACyH,cAAZ,GAA6BzE,MAA7B,GAAsC,CAArD,IAA0D,KAAI,CAAC2E,YAAL,IAAqB,IAAnF,EAAyF;QACvF,IAAIC,SAAS,SAAS3H,SAAS,CAACC,YAAV,CAAuBH,YAAvB,CAAoC;UAAEK,KAAK,EAAE;QAAT,CAApC,CAAtB;QACA,MAAMwH,SAAS,CAACH,cAAV,GAA2BpG,OAA3B,CAAmCC,KAAK,IAAItB,WAAW,EAAEuB,QAAb,CAAsBD,KAAtB,CAA5C,CAAN,CAFuF,CAGvF;MACD;IAZgB;EAalB;;EAEKkG,aAAa;IAAA;;IAAA;MACjB,IAAI,MAAI,CAACF,MAAL,CAAYnG,KAAZ,IAAqB,IAAzB,EAA+B;QAC7B;MACD;;MACD,MAAMnB,WAAW,GAAG,MAAI,CAACsH,MAAL,CAAYnG,KAAhC;MACAnB,WAAW,EAAE6H,cAAb,GAA8BxG,OAA9B,CAAsCC,KAAK,IAAG;QAC5CA,KAAK,CAACoG,OAAN,GAAgB,MAAI,CAACI,YAArB;MACD,CAFD;;MAGA,IAAI9H,WAAW,IAAIA,WAAW,CAAC6H,cAAZ,GAA6B7E,MAA7B,GAAsC,CAArD,IAA0D,MAAI,CAAC8E,YAAL,IAAqB,IAAnF,EAAyF;QACvF,IAAIF,SAAS,SAAS3H,SAAS,CAACC,YAAV,CAAuBH,YAAvB,CAAoC;UAAEI,KAAK,EAAE;QAAT,CAApC,CAAtB;QACA,MAAMyH,SAAS,CAACC,cAAV,GAA2BxG,OAA3B,CAAmCC,KAAK,IAAItB,WAAW,EAAEuB,QAAb,CAAsBD,KAAtB,CAA5C,CAAN,CAFuF,CAGvF;MACD;IAZgB;EAalB;;EAEDyG,WAAW,CAACvD,KAAD,EAAa;IACtB,KAAKmD,YAAL,GAAoB,CAAC,KAAKA,YAA1B;IACA,KAAKJ,aAAL;EACD;;EAEDS,WAAW,CAACxD,KAAD,EAAa;IACtB,KAAKsD,YAAL,GAAoB,CAAC,KAAKA,YAA1B;IACA,KAAKN,aAAL;EACD;;AA1F4B;;;mBAAlB1B;AAAkB;;;QAAlBA;EAAkB3G;EAAAgE;IAAA;;;;;;;;;;;;;;;;;;;;;MCR/B3E,4DAAAA,iBAC8E,CAD9E,EAC8E,KAD9E,EAC8E,CAD9E;MAGIA,uDAAAA;MACAA,4DAAAA,cAAmC,CAAnC,EAAmC,MAAnC,EAAmC,CAAnC;MACoCA,oDAAAA;MAAYA,0DAAAA;MAEhDA,4DAAAA,cAA6E,CAA7E,EAA6E,QAA7E,EAA6E,CAA7E;MACUA,wDAAAA;QAAA,OAAS4E,uBAAT;MAA4B,CAA5B;MAEN5E,4DAAAA;MAAsBA,oDAAAA;MAAYA,0DAAAA;MAClCA,4DAAAA;MAAAA,4DAAAA;MAEEA,uDAAAA;MAEAA,oDAAAA;MACFA,0DAAAA;MAEFA,6DAAAA;MAAAA,4DAAAA;MAAQA,wDAAAA;QAAA,OAAS4E,uBAAT;MAA4B,CAA5B;MAEN5E,4DAAAA;MAAsBA,oDAAAA;MAAYA,0DAAAA;MAClCA,4DAAAA;MAAAA,4DAAAA;MAEEA,uDAAAA;MAEFA,0DAAAA;;;;MAtBYA,uDAAAA;MAAAA,wDAAAA;MAEoBA,uDAAAA;MAAAA,+DAAAA;MAIhCA,uDAAAA;MAAAA,oEAAAA;MAUAA,uDAAAA;MAAAA,oEAAAA;;;;;;;;;;;;;;;;;;;;;;AClBiE;AACL;;;;;;;AAQ7D,MAAM,iBAAiB;IAQ5B,YAAoB,WAAwB,EAAU,IAAgB,EAAU,MAAc;QAA1E,gBAAW,GAAX,WAAW,CAAa;QAAU,SAAI,GAAJ,IAAI,CAAY;QAAU,WAAM,GAAN,MAAM,CAAQ;QAC5F,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YAC3C,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC,+DAAmB,CAAC,CAAC;YACvC,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC,+DAAmB,CAAC,CAAC;SACxC,CAAC,CAAC;QACH,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YACzC,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC,+DAAmB,CAAC,CAAC;YACvC,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC,+DAAmB,CAAC,CAAC;SACxC,CAAC,CAAC;IACL,CAAC;IAED,QAAQ;IACR,CAAC;IAED,YAAY,CAAC,KAAY;QACvB,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QACjC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAED,aAAa,CAAC,KAAY;QACxB,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QACjC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAED,gBAAgB;QACd,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QACnE,MAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAChC,MAAM,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC;QAC3C,KAAK,IAAI,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACtC,QAAQ,CAAC,MAAM,CAAC,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;YACtC,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;SACnC;QACD,0BAA0B;QAC1B,qCAAqC;QACrC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,QAAQ,CAAC,CAAC,SAAS,CAAC;YACpD,IAAI,EAAE,CAAC,IAAS,EAAE,EAAE;gBAClB,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACnB,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;gBAC/D,IAAI,CAAC,eAAe,EAAE,CAAC;YACzB,CAAC;YACD,KAAK,EAAE,CAAC,GAAQ,EAAE,EAAE;gBAClB,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACrB,CAAC;SACF,CAAC;IACJ,CAAC;IAED,UAAU,CAAC,KAAY;QACrB,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QACjC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IACzD,CAAC;IAED,WAAW,CAAC,KAAY;QACtB,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QACjC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IACzD,CAAC;IAED,cAAc;QACZ,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAC/D,MAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAChC,MAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QACzC,KAAK,IAAI,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACtC,QAAQ,CAAC,MAAM,CAAC,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;YACtC,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;SACnC;QACD,0BAA0B;QAC1B,qCAAqC;QACrC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC,SAAS,CAAC;YACjD,IAAI,EAAE,CAAC,IAAS,EAAE,EAAE;gBAClB,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACnB,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;gBAC/D,IAAI,CAAC,eAAe,EAAE,CAAC;YACzB,CAAC;YACD,KAAK,EAAE,CAAC,GAAQ,EAAE,EAAE;gBAClB,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACrB,CAAC;SACF,CAAC;IACJ,CAAC;IAED,eAAe;QACb,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC,CAAC;IACvC,CAAC;IAED,eAAe,CAAC,KAAY;QAC1B,KAAK,CAAC,wBAAwB,EAAE,CAAC;IACnC,CAAC;;kFAhGU,iBAAiB;+GAAjB,iBAAiB;;;;;;;;QCV9B,yEAAqD;QAEjB,uEAAY;QAAA,4DAAK;QAEnD,yEAAuC;QAIC,iFAAsB;QAAA,4DAAO;QAC7D,2EAAgD;QAAA,+EAAmB;QAAA,4DAAO;QAE5E,wEAAkC;QAChC,kMAEF;QAAA,4DAAI;QACJ,2EAAmD;QACzC,gJAAS,wBAAoB,IAAC;QAEpC,yEACF;QAAA,4DAAS;QACT,8EACsJ;QAD9I,gJAAS,sBAAkB,IAAC;QAElC,uEACF;QAAA,4DAAS;QAIf,qEACM;QACR,4DAAM;QAEN,+EAA+F;QAA9E,6IAAS,yBAAqB,IAAC;QAC9C,2EAA2G;QAAtG,6IAAS,2BAAuB,IAAC;QACpC,2EAAsE;QACtC,uEAAW;QAAA,4DAAK;QAC9C,qEAA2C;QAC3C,4EAA6F;QAA1D,0IAAU,sBAAkB,IAAC;QAC9D,wEAEmN;QAMnN,8EACwO;QACtO,mFACF;QAAA,4DAAS;QAOjB,+EAA2F;QAA5E,6IAAS,uBAAmB,IAAC;QAC1C,2EAA2G;QAAtG,6IAAS,2BAAuB,IAAC;QACpC,2EAAsE;QACtC,qEAAS;QAAA,4DAAK;QAC5C,qEAAwC;QACxC,4EAAyF;QAAxD,0IAAU,oBAAgB,IAAC;QAC1D,wEAEmN;QAMnN,8EACwO;QACtO,gFACF;QAAA,4DAAS;;QApCL,2DAA4B;QAA5B,yFAA4B;QAwB5B,2DAA0B;QAA1B,uFAA0B;;;;;;;;;;;;;;;;;;;;AC5DxC;;;;AAQM,MAAOyJ,kBAAP,CAAyB;EAQ7BvJ,YAAoBwJ,MAApB,EAAkC;IAAd;IAJpB,mBAAc;MAAE/H,KAAK,EAAE,IAAT;MAAeC,KAAK,EAAE;IAAtB,CAAd;IAEA,eAAe,IAAf;EAEuC;;EAEvCxB,QAAQ;IACN,KAAKuJ,cAAL;IACA,IAAIC,OAAO,GAAGzI,MAAM,CAAC0I,cAAP,CAAsBxI,OAAtB,CAA8B,SAA9B,CAAd;;IACA,IAAIuI,OAAO,IAAI,IAAf,EAAqB;MACnB,KAAKE,OAAL,GAAeC,IAAI,CAACC,KAAL,CAAWJ,OAAX,CAAf;IACD;EACF;;EAEKD,cAAc;IAAA;;IAAA;MAClB,KAAI,CAACnI,WAAL,SAAyBC,SAAS,CAACC,YAAV,CAAuBH,YAAvB,CAAoC,KAAI,CAAC0I,WAAzC,CAAzB;MACA,KAAI,CAACC,YAAL,CAAkBlG,aAAlB,CAAgCC,SAAhC,GAA4C,KAAI,CAACzC,WAAjD;IAFkB;EAGnB;;EAEK+H,WAAW;IAAA;;IAAA;MACf,MAAI,CAACU,WAAL,CAAiBrI,KAAjB,GAAyB,CAAC,MAAI,CAACqI,WAAL,CAAiBrI,KAA3C;MACA,MAAM,MAAI,CAACJ,WAAL,CAAiByH,cAAjB,GAAkCpG,OAAlC,CAA0CC,KAAK,IAAG;QACtDA,KAAK,CAACoG,OAAN,GAAgB,MAAI,CAACe,WAAL,CAAiBrI,KAAjC;MACD,CAFK,CAAN;IAFe;EAKhB;;EACK4H,WAAW;IAAA;;IAAA;MACf,MAAI,CAACS,WAAL,CAAiBtI,KAAjB,GAAyB,CAAC,MAAI,CAACsI,WAAL,CAAiBtI,KAA3C;MACA,MAAM,MAAI,CAACH,WAAL,CAAiB6H,cAAjB,GAAkCxG,OAAlC,CAA0CC,KAAK,IAAG;QACtDA,KAAK,CAACoG,OAAN,GAAgB,MAAI,CAACe,WAAL,CAAiBtI,KAAjC;MACD,CAFK,CAAN;IAFe;EAKhB;;EAEDwI,QAAQ;IACNhJ,MAAM,CAAC0I,cAAP,CAAsBO,OAAtB,CAA8B,YAA9B,EAA4CL,IAAI,CAACM,SAAL,CAAe,KAAKJ,WAApB,CAA5C;IACA,KAAKzI,WAAL,CAAiBoB,SAAjB,GAA6BC,OAA7B,CAAqCC,KAAK,IAAIA,KAAK,CAACwH,IAAN,EAA9C;IACA,KAAKZ,MAAL,CAAYa,aAAZ,CAA0B,OAA1B;EACD;;EAEDC,WAAW;IACT,KAAKhJ,WAAL,CAAiBoB,SAAjB,GAA6BC,OAA7B,CAAqCC,KAAK,IAAIA,KAAK,CAACwH,IAAN,EAA9C;IACA,KAAKZ,MAAL,CAAYa,aAAZ,CAA0B,GAA1B;EACD;;EAEDE,SAAS;IACP,IAAIC,QAAQ,GAAG,WAAWvJ,MAAM,CAACwJ,QAAP,CAAgBC,IAAI,SAAS,KAAKd,OAAL,CAAae,QAAQ,EAA5E;IACApJ,SAAS,CAACqJ,SAAV,CAAoBC,SAApB,CAA8BL,QAA9B;EACD;;AAlD4B;;;mBAAlBjB,oBAAkBzJ,+DAAAA,CAAAA,mDAAAA;AAAA;;;QAAlByJ;EAAkB9I;EAAAgE;IAAA;;;;;;;;;;;;;;;MCR/B3E,4DAAAA,cAAqD,CAArD,EAAqD,KAArD,EAAqD,CAArD,EAAqD,CAArD,EAAqD,IAArD,EAAqD,CAArD;MAEoCA,oDAAAA;MAAYA,0DAAAA;MAE9CA,4DAAAA,WAAK,CAAL,EAAK,KAAL,EAAK,CAAL,EAAK,CAAL,EAAK,KAAL,EAAK,CAAL,EAAK,CAAL,EAAK,KAAL,EAAK,CAAL;MAIQA,uDAAAA;MAEAA,4DAAAA,eAAyD,EAAzD,EAAyD,KAAzD,EAAyD,CAAzD,EAAyD,EAAzD,EAAyD,QAAzD,EAAyD,EAAzD;MAEYA,wDAAAA;QAAA,OAAS4E,iBAAT;MAAsB,CAAtB;MAEN5E,4DAAAA;MAAsBA,oDAAAA;MAAYA,0DAAAA;MAClCA,4DAAAA;MAAAA,4DAAAA;MAEEA,uDAAAA;MAEAA,oDAAAA;MACFA,0DAAAA;MAEFA,6DAAAA;MAAAA,4DAAAA;MAAQA,wDAAAA;QAAA,OAAS4E,iBAAT;MAAsB,CAAtB;MAEN5E,4DAAAA;MAAsBA,oDAAAA;MAAYA,0DAAAA;MAClCA,4DAAAA;MAAAA,4DAAAA;MAEEA,uDAAAA;MAEFA,0DAAAA;MAMRA,6DAAAA;MAAAA,4DAAAA,gBAAoB,EAApB,EAAoB,KAApB,EAAoB,EAApB,EAAoB,EAApB,EAAoB,IAApB,EAAoB,EAApB;MAIMA,oDAAAA;MACFA,0DAAAA;MACAA,4DAAAA;MAAiBA,wDAAAA;QAAA,OAAS4E,cAAT;MAAmB,CAAnB;MAC+I5E,oDAAAA;MAC1JA,0DAAAA;MACNA,4DAAAA;MAAiBA,wDAAAA;QAAA,OAAS4E,iBAAT;MAAsB,CAAtB;MAC+I5E,oDAAAA;MACvJA,0DAAAA;MACTA,4DAAAA;MAAiBA,wDAAAA;QAAA,OAAS4E,eAAT;MAAoB,CAApB;MAC+I5E,oDAAAA;MAC1JA,0DAAAA;;;;MAzCaA,uDAAAA;MAAAA,wDAAAA,mBAAiB,OAAjB,EAAiB4E,qBAAjB;MAKf5E,uDAAAA;MAAAA,oEAAAA;MAUAA,uDAAAA;MAAAA,oEAAAA;MAgBFA,uDAAAA;MAAAA,gEAAAA;;;;;;;;;;;;;;;;;;;;;;;;;ACvCd;AACA;AAGA;;;;;;;;;ICKEA,4DAAAA;IACEA,uDAAAA;IACFA,0DAAAA;;;;;IADSA,uDAAAA;IAAAA,wDAAAA,yBAAoB,UAApB,EAAoB,IAApB,EAAoB,OAApB,EAAoB,IAApB;;;;ADCL,MAAOgB,iBAAP,CAAwB;EAQ5Bd,YAAoBuD,MAApB,EAAmDxC,WAAnD,EAA2E;IAAvD;IAA+B;IAPnD,eAAe,IAAf;IACA,aAA+C,IAAIgK,GAAJ,EAA/C;IAGA,kBAAiC,IAAjC;IACA,mBAAc,IAAIlL,iDAAJ,CAAwC,IAAxC,CAAd;EAEgF;;EAEhFK,QAAQ;IACN,IAAI8K,IAAI,GAAG/J,MAAM,CAAC0I,cAAP,CAAsBxI,OAAtB,CAA8B,SAA9B,CAAX;;IACA,IAAI6J,IAAI,IAAI,IAAZ,EAAkB;MAChB,KAAKpB,OAAL,GAAeC,IAAI,CAACC,KAAL,CAAWkB,IAAX,CAAf;IACD;;IACDzJ,SAAS,CAACC,YAAV,CAAuBH,YAAvB,CAAoC;MAAEI,KAAK,EAAE,IAAT;MAAeC,KAAK,EAAE;IAAtB,CAApC,EAAkEc,IAAlE,CACGyI,KAAD,IAAU;MACR,KAAKC,UAAL,GAAkBD,KAAlB;MACA,KAAKhH,WAAL,CAAiB5D,IAAjB,CAAsB,KAAK6K,UAA3B;MACA,KAAK3H,MAAL,CAAYoD,WAAZ,GAA0BvG,SAA1B,CAAoC;QAClCC,IAAI,EAAGC,GAAD,IAAQ;UACZ,KAAK6K,aAAL,CAAmB7K,GAAnB;QACD;MAHiC,CAApC;MAKA,KAAKiD,MAAL,CAAY6H,eAAZ,GAA8BhL,SAA9B,CAAwC;QACtCC,IAAI,EAAGgL,KAAD,IAAkB;UACtB,IAAIA,KAAK,IAAI,MAAb,EAAqB;YACnB,KAAK9H,MAAL,CAAYwD,UAAZ,CAAuBN,qEAAvB,EAAwC,KAAKmD,OAA7C;UACD;QACF;MALqC,CAAxC;IAOD,CAhBH;EAkBD;;EAEKuB,aAAa,CAAC7K,GAAD,EAAS;IAAA;;IAAA;MAC1B,IAAIA,GAAG,IAAI,IAAX,EAAiB;QAAE;MAAS;;MAC5B,QAAQA,GAAG,CAAC4B,IAAZ;QACE,KAAKuE,qEAAL;UACElG,OAAO,CAACC,IAAR,CAAa,4BAAb,EAA2CF,GAAG,CAACgC,IAAJ,CAAS2E,QAApD;;UACA,KAAI,CAACsE,KAAL,CAAWC,GAAX,CAAelL,GAAG,CAACgC,IAAJ,CAAS2E,QAAxB,EAAkC,IAAlC;;UACA,KAAI,CAACwE,mBAAL,CAAyBnL,GAAG,CAACgC,IAA7B;;UACA;;QACF,KAAKmE,sEAAL;UACElG,OAAO,CAACC,IAAR,CAAa,gCAAb,EAA+CF,GAAG,CAACgC,IAAJ,CAAS2E,QAAxD;;UACA,KAAI,CAAC0E,qBAAL,CAA2BrL,GAAG,CAACgC,IAA/B;;UACA;;QACF,KAAKmE,kEAAL;UACElG,OAAO,CAACC,IAAR,CAAa,qBAAb,EAAoCF,GAAG,CAACgC,IAAJ,CAAS2E,QAA7C;;UACA,KAAI,CAAC4E,oBAAL,CAA0BvL,GAAG,CAACgC,IAA9B;;UACA;;QACF,KAAKmE,mEAAL;UACElG,OAAO,CAACC,IAAR,CAAa,sBAAb,EAAqCF,GAAG,CAACgC,IAAJ,CAAS2E,QAA9C;;UACA,KAAI,CAAC8E,gBAAL,CAAsBzL,GAAG,CAACgC,IAA1B;;UACA;QACF;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MA5BF;IAF0B;EAgC3B;;EAEKmJ,mBAAmB,CAACO,MAAD,EAAY;IAAA;;IAAA;MACnC,IAAIxI,UAAU,GAAG,MAAI,CAACzC,WAAL,CAAiBkL,gBAAjB,CAAkC,MAAI,CAACrC,OAAL,CAAa3C,QAA/C,CAAjB;;MACA,MAAI,CAACsE,KAAL,CAAWC,GAAX,CAAeQ,MAAM,CAAC/E,QAAtB,EAAgCzD,UAAhC;;MACAjD,OAAO,CAACC,IAAR,CAAa,MAAI,CAAC+K,KAAlB;MACA,MAAM,MAAI,CAACxK,WAAL,CAAiBmL,SAAjB,CAA2B1I,UAA3B,EAAuC,MAAI,CAACoG,OAAL,CAAa3C,QAApD,CAAN;IAJmC;EAKpC;;EAEK4E,oBAAoB,CAACG,MAAD,EAAY;IAAA;;IAAA;MACpC,IAAIxI,UAAU,GAAG,MAAI,CAAC+H,KAAL,CAAWY,GAAX,CAAeH,MAAM,CAAC/E,QAAtB,CAAjB;;MACA,IAAIzD,UAAU,IAAIC,SAAlB,EAA6B;QAC3BD,UAAU,GAAG,MAAI,CAACzC,WAAL,CAAiBkL,gBAAjB,CAAkC,MAAI,CAACrC,OAAL,CAAa3C,QAA/C,CAAb;;QACA,MAAI,CAACsE,KAAL,CAAWC,GAAX,CAAeQ,MAAM,CAAC/E,QAAtB,EAAgCzD,UAAhC;;QACAjD,OAAO,CAAC6L,IAAR,CAAa,0BAAb,EAAyCJ,MAAM,CAAC/E,QAAhD,EAA0D,MAAI,CAACsE,KAA/D;MACD;;MACD,MAAM,MAAI,CAACxK,WAAL,CAAiBsL,aAAjB,CAA+B7I,UAA/B,EAA2C,MAAI,CAAC0H,UAAhD,CAAN;MACA,MAAM,MAAI,CAACnK,WAAL,CAAiBuL,UAAjB,CAA4B9I,UAA5B,EAAwCwI,MAAM,CAAC1G,IAA/C,EAAqD0G,MAAM,CAAC/E,QAA5D,CAAN;;MACAzD,UAAU,CAACG,OAAX,GAAsB4I,GAAD,IAAuB;QAC1ChM,OAAO,CAACC,IAAR,CAAa,gBAAb;MACD,CAFD;;MAGA,MAAI,CAAC+C,MAAL,CAAYwD,UAAZ,CAAuBN,wEAAvB,EAA2C;QAAEgG,CAAC,EAAE,MAAI,CAAC7C,OAAL,CAAa3C,QAAlB;QAA4ByF,CAAC,EAAEV,MAAM,CAAC/E;MAAtC,CAA3C;IAZoC;EAarC;;EAEK8E,gBAAgB,CAACC,MAAD,EAAY;IAAA;;IAAA;MAChC,IAAIxI,UAAU,GAAG,MAAI,CAAC+H,KAAL,CAAWY,GAAX,CAAeH,MAAM,CAAC/E,QAAtB,CAAjB;;MACA,IAAIzD,UAAU,IAAIC,SAAlB,EAA6B;QAC3B;MACD;;MACDD,UAAU,CAACG,OAAX,GAAsB4I,GAAD,IAAuB;QAC1ChM,OAAO,CAAC6L,IAAR,CAAa,eAAb,EAA8BG,GAA9B;MACD,CAFD;IALgC;EAQjC;;EAEKZ,qBAAqB,CAACK,MAAD,EAAY;IAAA;;IAAA;MACrC,IAAIxI,UAAU,GAAG,MAAI,CAAC+H,KAAL,CAAWY,GAAX,CAAeH,MAAM,CAAC/E,QAAtB,CAAjB;;MACA,IAAIzD,UAAU,IAAIC,SAAlB,EAA6B;QAC3BlD,OAAO,CAAC6L,IAAR,CAAa,0BAAb,EAAyCJ,MAAM,CAAC/E,QAAhD,EAA0D,MAAI,CAACsE,KAA/D;QACA;MACD;;MACDhL,OAAO,CAAC0B,GAAR,CAAY+J,MAAZ;MACA,MAAM,MAAI,CAACjL,WAAL,CAAiB4L,gBAAjB,CAAkCnJ,UAAlC,EAA8CwI,MAAM,CAAClJ,SAArD,CAAN;IAPqC;EAQtC;;AA7G2B;;;mBAAjBhC,mBAAiBhB,+DAAAA,CAAAA,mEAAAA,GAAAA,+DAAAA,CAAAA,+DAAAA;AAAA;;;QAAjBgB;EAAiBL;EAAAgE;IAAA;wEAGQqG,2DAAgBA;;;;;;;;;;;;;;MCbtDhL,uDAAAA;MAEAA,4DAAAA;MACEA,gEAAAA;MACFA,0DAAAA;MAEAA,uDAAAA;MACAA,wDAAAA,4EAAAA,oEAAAA;;;;MADeA,uDAAAA;MAAAA,wDAAAA,mCAA6B,UAA7B,EAA6B4E,oBAA7B;;;;;;;;;;;;;;;;;;;;;;;ACNf;;;AAKM,MAAOkI,WAAP,CAAkB;EAKtB5M,YAAoBuD,MAApB,EAAyC;IAArB,qBAAqB,CACvC;IACA;IACA;IACA;EACD;;EAEDsJ,SAAS,CAACtH,MAAD,EAAoB;IAC3B,KAAKA,MAAL,GAAcA,MAAd;EACD;;EAED4F,aAAa,CAACtE,IAAD,EAAU,CACrB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EACD;;EAEDoF,gBAAgB,CAACD,MAAD,EAAsB;IACpC,IAAIxI,UAAU,GAAG,IAAIkC,iBAAJ,EAAjB;;IACAlC,UAAU,CAACqC,cAAX,GAA6BiH,EAAD,IAAkC;MAC5DvM,OAAO,CAACC,IAAR,CAAa,EAAb;MACA,KAAK+C,MAAL,CAAYwD,UAAZ,CAAuBN,6DAAvB,EAAyC;QAAE3D,SAAS,EAAEgK,EAAE,CAAChK,SAAH,EAAciK,MAAd,EAAb;QAAqC9F,QAAQ,EAAE+E;MAA/C,CAAzC;IACD,CAHD;;IAIAxI,UAAU,CAACwJ,uBAAX,GAAsCF,EAAD,IAAc;MACjDvM,OAAO,CAAC6L,IAAR,CAAa,6BAAb,EAA4C5I,UAAU,CAACyJ,eAAvD;IACD,CAFD;;IAGA,OAAOzJ,UAAP;EACD;;EAEK0I,SAAS,CAAC1I,aAAuC,IAAxC,EAA8CL,KAAoB,IAAlE,EAAsE;IAAA;;IAAA;MACnF,IAAIK,UAAU,IAAI,IAAlB,EAAwB;QACtBA,UAAU,GAAG,KAAI,CAACyI,gBAAL,CAAsB9I,EAAtB,CAAb;MACD;;MACD,IAAIyB,WAAW,SAASpB,UAAU,CAACe,WAAX,CAAuB;QAAEM,mBAAmB,EAAE,IAAvB;QAA6BC,mBAAmB,EAAE;MAAlD,CAAvB,CAAxB;MACA,MAAMtB,UAAU,CAACuB,mBAAX,CAA+BH,WAA/B,CAAN;;MACA,KAAI,CAACrB,MAAL,CAAYwD,UAAZ,CAAuBN,yDAAvB,EAAqC;QAAEnB,IAAI,EAAE9B,UAAU,CAAC4B,gBAAX,EAA6B2H,MAA7B,EAAR;QAA+C9F,QAAQ,EAAE9D;MAAzD,CAArC;IANmF;EAOpF;;EAEKmJ,UAAU,CAAC9I,UAAD,EAAgCyB,KAAhC,EAAkE9B,EAAlE,EAAmF;IAAA;;IAAA;MACjG;MACA,MAAMK,UAAU,CAACjB,oBAAX,CAAgC,IAAI2C,qBAAJ,CAA0BD,KAA1B,CAAhC,CAAN;MACA,IAAIE,MAAM,SAAS3B,UAAU,CAACU,YAAX,EAAnB;MACA,MAAMV,UAAU,CAACuB,mBAAX,CAA+BI,MAA/B,CAAN;;MACA,MAAI,CAAC5B,MAAL,CAAYwD,UAAZ,CAAuBN,0DAAvB,EAAsC;QAAEnB,IAAI,EAAEH,MAAR;QAAgB8B,QAAQ,EAAE9D;MAA1B,CAAtC;IALiG;EAMlG;;EAEKkJ,aAAa,CAAC7I,UAAD,EAAgC+B,MAAhC,EAA0D;IAAA;MAC3E,IAAIA,MAAM,IAAI,IAAd,EAAoB;QAClB;MACD;;MACDA,MAAM,CAAC7C,SAAP,GAAmBC,OAAnB,CAA4BC,KAAD,IAAU;QAAGY,UAAU,CAACX,QAAX,CAAoBD,KAApB;MAA4B,CAApE,EAJ2E,CAK3E;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IAjB2E;EAkB5E;;EAEK+J,gBAAgB,CAACnJ,UAAD,EAAgCV,SAAhC,EAA8C;IAAA;MAClE,IAAIU,UAAU,CAAC0J,iBAAX,IAAgC,IAApC,EAA0C;QACxC3M,OAAO,CAAC0B,GAAR,CAAY,yBAAZ;QACA;MACD;;MACD,IAAIa,SAAS,IAAI,IAAjB,EAAuB;QAAE;MAAS,CALgC,CAMlE;;;MACA,MAAMU,UAAU,CAACR,eAAX,CAA2B,IAAID,eAAJ,CAAoBD,SAApB,CAA3B,CAAN;IAPkE;EAQnE;;AAtFqB;;;mBAAX8J,aAAW9M,sDAAAA,CAAAA,0DAAAA;AAAA;;;SAAX8M;EAAWrG,SAAXqG,WAAW;EAAApG,YAFV;;;;;;;;;;;;;;;;;;ACHyB;;AAEvC,IAAY,MAEX;AAFD,WAAY,MAAM;IAChB,qCAAK;IAAE,uCAAM;IAAE,6CAAS;IAAE,iDAAW;IAAE,2CAAQ;IAAE,qCAAK;IAAE,mCAAI;IAAE,6CAAS;IAAE,+CAAU;IAAE,mDAAY;AACnG,CAAC,EAFW,MAAM,KAAN,MAAM,QAEjB;AAMM,MAAM,aAAa;IAMxB;QAHQ,gBAAW,GAAG,IAAI,iDAAe,CAAS,UAAU,CAAC,CAAC;QACtD,aAAQ,GAAG,IAAI,iDAAe,CAAM,IAAI,CAAC,CAAC;QAGhD,IAAI,CAAC,OAAO,EAAE,CAAC;IACjB,CAAC;IAED,OAAO,CAAC,OAAe,mBAAmB,EAAE,OAAe,QAAQ;QACjE,IAAI,CAAC,UAAU,GAAG,IAAI,SAAS,CAAC,QAAQ,IAAI,IAAI,IAAI,GAAG,CAAC,CAAC;QACzD,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,KAAY,EAAE,EAAE,GAAG,IAAI,CAAC,wBAAwB,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;QAC5F,IAAI,CAAC,UAAU,CAAC,OAAO,GAAG,CAAC,KAAiB,EAAE,EAAE,GAAG,IAAI,CAAC,wBAAwB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;QACnG,IAAI,CAAC,UAAU,CAAC,OAAO,GAAG,CAAC,KAAY,EAAE,EAAE,GAAG,IAAI,CAAC,wBAAwB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;QAC9F,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,CAAC,KAAmB,EAAE,EAAE,GAAG,IAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;IACpG,CAAC;IAED,eAAe;QACb,OAAO,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC;IACzC,CAAC;IAED,WAAW;QACT,OAAO,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC;IACtC,CAAC;IAED,UAAU,CAAC,IAAY,EAAE,IAAS,EAAE,YAA2B,IAAI;QACjE,MAAM,UAAU,GAAG;YACjB,IAAI,EAAE,IAAI;YACV,IAAI,EAAE,IAAI;SACX,CAAC;QACF,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;IACvC,CAAC;IAED,QAAQ,CAAC,IAAS,EAAE,YAA2B,IAAI;QACjD,IAAI;YACF,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;SAClC;QAAC,OAAO,SAAS,EAAE;YAClB,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;YACzB,MAAM,SAAS,CAAC;SACjB;IACH,CAAC;IAED,UAAU,CAAC,IAAS,EAAE,YAA2B,IAAI;QACnD,IAAI;YACF,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC5B;QAAC,OAAO,SAAS,EAAE;YAClB,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;SAC1B;IACH,CAAC;IAED,UAAU,CAAC,IAAY,EAAE,YAA2B,IAAI;QACtD,IAAI;YACF,MAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,CAAC,CAAC;YAC3E,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;SACxC;QAAC,OAAO,SAAS,EAAE;YAClB,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;SAC1B;IACH,CAAC;IAEO,iBAAiB,CAAC,KAAa,EAAE,KAAmB;QAC1D,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC;IACrD,CAAC;IAEO,wBAAwB,CAAC,KAAa,EAAE,KAAY;QAC1D,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC/B,CAAC;;0EAlEU,aAAa;8GAAb,aAAa,WAAb,aAAa,mBAFZ,MAAM;;;;;;;;;;;;;;;;;;;;ACRmC;AACmB;AACG;AACH;;;AAE1E,MAAM,MAAM,GAAW;IACrB,EAAE,IAAI,EAAE,EAAE,EAAE,SAAS,EAAE,mFAAiB,EAAE;IAC1C,EAAE,IAAI,EAAE,OAAO,EAAE,SAAS,EAAE,sFAAkB,EAAE;IAChD,EAAE,IAAI,EAAE,MAAM,EAAE,SAAS,EAAE,mFAAiB,EAAE;CAC/C,CAAC;AAMK,MAAM,mBAAmB;;sFAAnB,mBAAmB;gHAAnB,mBAAmB;oHAHpB,kEAAqB,CAAC,MAAM,CAAC,EAC7B,yDAAY;mIAEX,mBAAmB,oFAFpB,yDAAY;;;;;;;;;;;;;;;;;;;;;;;;;;ACbuB;AAC2B;AACG;AACH;AACR;AACV;AACM;AACoB;AACN;AACG;;AAqBxE,MAAM,YAAY;;wEAAZ,YAAY;yGAAZ,YAAY;6GAPrB,yDAAY;QACZ,uEAAmB;QACnB,uDAAW;QACX,+DAAmB;QACnB,mEAAgB;mIAGP,YAAY,mBAfrB,mFAAiB;QACjB,sFAAkB;QAClB,mFAAiB;QACjB,2FAAkB;QAClB,qFAAgB;QAChB,wFAAiB,aAGjB,yDAAY;QACZ,uEAAmB;QACnB,uDAAW;QACX,+DAAmB;QACnB,mEAAgB;;;;;;;;;;;;;;;AC5BpB,gFAAgF;AAChF,mEAAmE;AACnE,gEAAgE;AAEzD,MAAM,WAAW,GAAG;IACzB,UAAU,EAAE,KAAK;CAClB,CAAC;AAEF;;;;;;GAMG;AACH,sEAAsE;;;;;;;;;;;;;;;;;ACfvB;AAGF;AACY;AAEzD,IAAI,6EAAsB,EAAE;IAC1B,6DAAc,EAAE,CAAC;CAClB;AAED,wEAAwB,CAAC,eAAe,CAAC,sDAAS,CAAC;KAChD,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC","sources":["./src/app/app-routing.module.ts","./src/app/app.component.ts","./src/app/app.module.ts","./src/app/components/chat-component/chat-component.component.ts","./src/app/components/chat-component/chat-component.component.html","./src/app/components/video-card/video-card.component.ts","./src/app/components/video-card/video-card.component.html","./src/app/components/video-grid/video-grid.component.ts","./src/app/components/video-grid/video-grid.component.html","./src/app/components/video-preview/video-preview.component.ts","./src/app/components/video-preview/video-preview.component.html","./src/app/components/video-stream/video-stream.component.ts","./src/app/components/video-stream/video-stream.component.html","./src/app/pages/page-home/page-home.component.ts","./src/app/pages/page-home/page-home.component.html","./src/app/pages/page-room/page-room.component.ts","./src/app/pages/page-room/page-room.component.html","./src/app/pages/page-single/page-single.component.ts","./src/app/pages/page-single/page-single.component.html","./src/app/services/remote-peers.service.ts","./src/app/services/signaling.service.ts","./src/app/webrtc/components/chat-box/chat-box.component.ts","./src/app/webrtc/components/chat-box/chat-box.component.html","./src/app/webrtc/components/room-poll/room-poll.component.ts","./src/app/webrtc/components/room-poll/room-poll.component.html","./src/app/webrtc/components/self-video/self-video.component.ts","./src/app/webrtc/components/self-video/self-video.component.html","./src/app/webrtc/pages/page-home/page-home.component.ts","./src/app/webrtc/pages/page-home/page-home.component.html","./src/app/webrtc/pages/page-lobby/page-lobby.component.ts","./src/app/webrtc/pages/page-lobby/page-lobby.component.html","./src/app/webrtc/pages/page-room/page-room.component.ts","./src/app/webrtc/pages/page-room/page-room.component.html","./src/app/webrtc/services/peer.service.ts","./src/app/webrtc/services/signal.service.ts","./src/app/webrtc/webrtc-routing.module.ts","./src/app/webrtc/webrtc.module.ts","./src/environments/environment.ts","./src/main.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { PageHomeComponent } from './pages/page-home/page-home.component';\r\nimport { PageRoomComponent } from './pages/page-room/page-room.component';\r\nimport { PageSingleComponent } from './pages/page-single/page-single.component';\r\nimport { WebrtcRoutingModule } from './webrtc/webrtc-routing.module';\r\n\r\nconst routes: Routes = [\r\n  // { path: '', component: PageHomeComponent },\r\n  // { path: 'room', component: PageRoomComponent },\r\n  // { path: 'single', component: PageSingleComponent }\r\n  { path: '', loadChildren: () => WebrtcRoutingModule },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forRoot(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class AppRoutingModule { }\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  template: '<router-outlet></router-outlet>',\r\n  styleUrls: []\r\n})\r\nexport class AppComponent {\r\n  title = 'conferencing';\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { BrowserModule } from '@angular/platform-browser';\r\n\r\nimport { AppRoutingModule } from './app-routing.module';\r\nimport { AppComponent } from './app.component';\r\nimport { PageHomeComponent } from './pages/page-home/page-home.component';\r\nimport { PageRoomComponent } from './pages/page-room/page-room.component';\r\nimport { VideoPreviewComponent } from './components/video-preview/video-preview.component';\r\nimport { VideoGridComponent } from './components/video-grid/video-grid.component';\r\nimport { VideoCardComponent } from './components/video-card/video-card.component';\r\nimport { ChatComponentComponent } from './components/chat-component/chat-component.component';\r\nimport { VideoStreamComponent } from './components/video-stream/video-stream.component';\r\nimport { PageSingleComponent } from './pages/page-single/page-single.component';\r\nimport { WebrtcModule } from './webrtc/webrtc.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent,\r\n    PageHomeComponent,\r\n    PageRoomComponent,\r\n    VideoPreviewComponent,\r\n    VideoGridComponent,\r\n    VideoCardComponent,\r\n    ChatComponentComponent,\r\n    VideoStreamComponent,\r\n    PageSingleComponent\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    AppRoutingModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    HttpClientModule,\r\n    WebrtcModule\r\n  ],\r\n  providers: [],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { Message, SignalingService } from 'src/app/services/signaling.service';\r\n\r\n@Component({\r\n  selector: 'app-chat-component',\r\n  templateUrl: './chat-component.component.html',\r\n  styleUrls: []\r\n})\r\nexport class ChatComponentComponent implements OnInit {\r\n\r\n  messages = new BehaviorSubject<Message[]>([]);\r\n\r\n  constructor(private signalService: SignalingService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.signalService.getMessageQueue().subscribe({\r\n      next: (msg) => {\r\n        console.info(msg);\r\n        // const val = this.messages.value;\r\n        // val.push(msg);\r\n        // console.log(msg);\r\n        // this.messages.next(val);\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n","<ul>\r\n  <li *ngFor=\"let msg of messages|async\">\r\n    <div>\r\n      <h5 class=\"text-lg font-medium\">{{msg.type}}</h5>\r\n      <p>{{msg.data}}</p>\r\n    </div>\r\n  </li>\r\n</ul>\r\n","import { Component, ElementRef, Input, OnInit, ViewChild } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-video-card',\r\n  templateUrl: './video-card.component.html',\r\n  styleUrls: []\r\n})\r\nexport class VideoCardComponent implements OnInit {\r\n\r\n  @Input() index: number = 0;\r\n  @Input() peer!: any;\r\n\r\n  @ViewChild('vidStream', { static: true }) vidStream !: ElementRef<HTMLVideoElement>;\r\n\r\n  @Input() stream: MediaStream | null = null;\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void { }\r\n\r\n  startTracking(peer: any): void {\r\n    this.peer = peer;\r\n    console.warn('Listening for track changes on:', peer.id);\r\n    this.peer.conn.ontrack = (event: RTCTrackEvent) => {\r\n      console.warn('Getting Tracks', event);\r\n      this.vidStream.nativeElement.srcObject = event.streams[0];\r\n    };\r\n  }\r\n\r\n}\r\n","<div class=\"relative block w-80 h-60 border border-slate-600 bg-slate-800\">\r\n  <div class=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2\">\r\n    <span class=\"text-3xl font-medium\">{{peer.id}}</span>\r\n  </div>\r\n  <video #vidStream [srcObject]=\"stream\" [autoplay]=\"true\"></video>\r\n</div>\r\n","import { Component, Input, OnInit } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { Connection } from 'src/app/pages/page-room/page-room.component';\r\nimport { RemotePeersService } from 'src/app/services/remote-peers.service';\r\n\r\n@Component({\r\n  selector: 'app-video-grid',\r\n  templateUrl: './video-grid.component.html',\r\n  styleUrls: []\r\n})\r\nexport class VideoGridComponent implements OnInit {\r\n\r\n  peers = new BehaviorSubject<any[]>([]);\r\n\r\n  @Input() connections !: Connection[];\r\n\r\n  constructor(private peerService: RemotePeersService) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div class=\"grid grid-cols-4 gap-2 grid-flow-row-dense p-4\">\r\n  <ng-container *ngFor=\"let peer of connections;let i = index\">\r\n    <app-video-card [peer]=\"peer.conn\" [index]=\"i\"></app-video-card>\r\n  </ng-container>\r\n</div>\r\n","import { AfterViewInit, Component, ElementRef, Input, OnInit, ViewChild } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-video-preview',\r\n  templateUrl: './video-preview.component.html',\r\n  styleUrls: []\r\n})\r\nexport class VideoPreviewComponent implements OnInit, AfterViewInit {\r\n\r\n  @Input() username = 'Sample User Name';\r\n  @Input() streamSource: BehaviorSubject<MediaStream | null> = new BehaviorSubject<MediaStream | null>(null);\r\n\r\n  @ViewChild('container', { static: true }) container !: ElementRef<HTMLDivElement>;\r\n  @ViewChild('preview', { static: true }) preview !: ElementRef<HTMLVideoElement>;\r\n\r\n  dragOffset = {\r\n    x: 0,\r\n    y: 0\r\n  };\r\n\r\n  videoEnabled = false;\r\n  audioEnabled = true;\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.container.nativeElement.ondragstart = (event) => {\r\n      event.stopImmediatePropagation();\r\n      this.dragOffset.x = event.offsetX;\r\n      this.dragOffset.y = event.offsetY;\r\n      this.preview.nativeElement.pause();\r\n    };\r\n    this.container.nativeElement.ondragend = (event) => {\r\n      event.stopImmediatePropagation();\r\n      this.preview.nativeElement.play();\r\n    };\r\n    this.container.nativeElement.ondrag = (event) => {\r\n      event.stopImmediatePropagation();\r\n      event.preventDefault();\r\n      if (event.screenX == 0 && event.screenY == 0) { return; }\r\n      this.container.nativeElement.style.top = `${event.clientY - this.dragOffset.y}px`;\r\n      this.container.nativeElement.style.right = `${window.innerWidth - event.clientX - this.dragOffset.x}px`;\r\n    };\r\n    this.streamSource.subscribe({\r\n      next: (stream) => {\r\n        this.preview.nativeElement.srcObject = stream;\r\n        \r\n        this.setVideoState();\r\n        this.setAudioState();\r\n      }\r\n    });\r\n  }\r\n\r\n  setVideoState() {\r\n    const mediaStream = this.streamSource.value;\r\n    mediaStream?.getVideoTracks().forEach(track => {\r\n      track.enabled = this.videoEnabled;\r\n    });\r\n  }\r\n\r\n  setAudioState() {\r\n    const mediaStream = this.streamSource.value;\r\n    mediaStream?.getAudioTracks().forEach(track => {\r\n      track.enabled = this.audioEnabled;\r\n    });\r\n  }\r\n\r\n  toggleVideo(event: Event) {\r\n    this.videoEnabled = !this.videoEnabled;\r\n    this.setVideoState();\r\n  }\r\n\r\n  toggleAudio(event: Event) {\r\n    this.audioEnabled = !this.audioEnabled;\r\n    this.setAudioState();\r\n  }\r\n\r\n}\r\n","<div #container draggable=\"true\" style=\"top: 0px; right: 0px;\"\r\n  class=\"fixed z-50 w-80 h-60 shadow-lg border border-slate-700 bg-slate-800\">\r\n  <div class=\"relative block w-full h-full\">\r\n    <video #preview [autoplay]=\"true\" style=\"transform: rotateY(180deg);\"></video>\r\n    <div class=\"absolute top-3 left-3\">\r\n      <span class=\"font-medium text-lg\">{{username}}</span>\r\n    </div>\r\n    <div class=\"absolute flex flex-row gap-3 bottom-3 left-1/2 -translate-x-1/2\">\r\n      <button (click)=\"toggleVideo($event)\"\r\n        class=\"outline-none appearance-none focus:ring shadow rounded-full p-2 {{videoEnabled == true ? 'bg-slate-600/50 ring-slate-400' : 'bg-red-600 ring-red-400'}}\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\"\r\n          class=\"w-6 h-6\">\r\n          <path stroke-linecap=\"round\"\r\n            d=\"M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z\" />\r\n          3\r\n        </svg>\r\n      </button>\r\n      <button (click)=\"toggleAudio($event)\"\r\n        class=\"outline-none appearance-none focus:ring shadow rounded-full p-2 {{audioEnabled == true ? 'bg-slate-600/50 ring-slate-400' : 'bg-red-600 ring-red-400'}}\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\"\r\n          class=\"w-6 h-6\">\r\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\"\r\n            d=\"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z\" />\r\n        </svg>\r\n\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-video-stream',\r\n  templateUrl: './video-stream.component.html',\r\n  styleUrls: ['./video-stream.component.scss']\r\n})\r\nexport class VideoStreamComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<p>video-stream works!</p>\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-page-home',\r\n  templateUrl: './page-home.component.html',\r\n  styleUrls: []\r\n})\r\nexport class PageHomeComponent implements OnInit {\r\n\r\n  @ViewChild('createRoom') createRoom !: ElementRef<HTMLElement>;\r\n  @ViewChild('joinRoom') joinRoom !: ElementRef<HTMLElement>;\r\n\r\n  createRoomForm !: FormGroup;\r\n  joinRoomForm !: FormGroup;\r\n\r\n  constructor(private formBuilder: FormBuilder, private http: HttpClient, private router: Router) {\r\n    this.createRoomForm = this.formBuilder.group({\r\n      username: [null, [Validators.required]],\r\n      roomname: [null, [Validators.required]],\r\n    });\r\n    this.joinRoomForm = this.formBuilder.group({\r\n      username: [null, [Validators.required]],\r\n      roomname: [null, [Validators.required]],\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  toggleCreate(event: Event) {\r\n    event.preventDefault();\r\n    event.stopImmediatePropagation();\r\n    this.createRoom.nativeElement.classList.toggle('hidden');\r\n  }\r\n\r\n  dismissCreate(event: Event) {\r\n    event.preventDefault();\r\n    event.stopImmediatePropagation();\r\n    this.createRoom.nativeElement.classList.toggle('hidden');\r\n  }\r\n\r\n  createRoomSubmit() {\r\n    console.info(this.createRoomForm.valid, this.createRoomForm.value);\r\n    const formData = new FormData();\r\n    formData.append('data', JSON.stringify(this.createRoomForm.value));\r\n    this.http.post('socket/create/room/', formData).subscribe({\r\n      next: (resp: any) => {\r\n        console.info(resp);\r\n      },\r\n      error: (err: any) => {\r\n        console.error(err);\r\n      }\r\n    })\r\n  }\r\n\r\n  toggleJoin(event: Event) {\r\n    event.preventDefault();\r\n    event.stopImmediatePropagation();\r\n    this.joinRoom.nativeElement.classList.toggle('hidden');\r\n  }\r\n\r\n  dismissJoin(event: Event) {\r\n    event.preventDefault();\r\n    event.stopImmediatePropagation();\r\n    this.joinRoom.nativeElement.classList.toggle('hidden');\r\n  }\r\n\r\n  joinRoomSubmit() {\r\n    console.info(this.joinRoomForm.valid, this.joinRoomForm.value);\r\n    const formData = new FormData();\r\n    formData.append('data', JSON.stringify(this.joinRoomForm.value));\r\n    this.http.post('socket/join/room/', formData).subscribe({\r\n      next: (resp: any) => {\r\n        console.info(resp);\r\n      },\r\n      error: (err: any) => {\r\n        console.error(err);\r\n      }\r\n    })\r\n  }\r\n\r\n  navigateToRoom(username: string) {\r\n    window.localStorage.setItem('username', username);\r\n    this.router.navigate(['/', 'room']);\r\n  }\r\n\r\n  stopPropagation(event: Event) {\r\n    event.stopImmediatePropagation();\r\n  }\r\n\r\n}\r\n","<div class=\"block min-h-screen w-full overflow-auto\">\r\n  <div class=\"flex flex-row items-center py-4 px-6 bg-indigo-700 shadow\">\r\n    <h1 class=\"text-xl font-medium\">Conferencing</h1>\r\n  </div>\r\n  <div class=\"flex flex-col lg:flex-row\">\r\n    <div class=\"w-full lg:w-1/2\">\r\n      <div class=\"py-8 px-6 lg:py-16 lg:px-12\">\r\n        <h1 class=\"text-3xl lg:text-5xl font-bold\">\r\n          <span class=\"inline-block pb-4\">Easy Conferencing with</span>\r\n          <span class=\"inline-block text-indigo-600 pb-4\">Web RTC and django.</span>\r\n        </h1>\r\n        <p class=\"text-lg text-slate-300\">\r\n          It is as simple as implementing the room based broadcast mechanism. To get started,\r\n          simply add your email address and create a room.\r\n        </p>\r\n        <div class=\"flex flex-col lg:flex-row gap-4 pt-16\">\r\n          <button (click)=\"toggleCreate($event)\"\r\n            class=\"px-4 py-3 rounded border shadow transition-all duration-300 ease-in-out bg-indigo-600 border-indigo-700 hover:bg-indigo-500\">\r\n            Create Room\r\n          </button>\r\n          <button (click)=\"toggleJoin($event)\"\r\n            class=\"px-4 py-3 rounded border shadow transition-all duration-300 ease-in-out text-indigo-800 bg-indigo-300 border-indigo-400 hover:bg-indigo-400\">\r\n            Join Room\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"w-full lg:w-1/2\">\r\n    </div>\r\n  </div>\r\n\r\n  <div #createRoom (click)=\"dismissCreate($event)\" class=\"fixed hidden inset-0 bg-indigo-900/80\">\r\n    <div (click)=\"stopPropagation($event)\" class=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2\">\r\n      <div class=\"flex flex-col px-6 py-4 w-96 rounded shadow bg-slate-800\">\r\n        <h3 class=\"text-xl font-bold\">Create Room</h3>\r\n        <br class=\"block border border-indigo-600\">\r\n        <form [formGroup]=\"createRoomForm\" (submit)=\"createRoomSubmit()\" class=\"flex flex-col gap-3\">\r\n          <input formControlName=\"username\" type=\"text\" name=\"username\" id=\"username-field-create\"\r\n            placeholder=\"Enter username for room\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-slate-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600\">\r\n\r\n          <input formControlName=\"roomname\" type=\"text\" name=\"roomname\" id=\"roomname-field-create\"\r\n            placeholder=\"Enter name of room\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-slate-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600\">\r\n\r\n          <button type=\"submit\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-indigo-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600 hover:bg-indigo-600\">\r\n            Create and Enter Room\r\n          </button>\r\n\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div #joinRoom (click)=\"dismissJoin($event)\" class=\"fixed hidden inset-0 bg-indigo-900/80\">\r\n    <div (click)=\"stopPropagation($event)\" class=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2\">\r\n      <div class=\"flex flex-col px-6 py-4 w-96 rounded shadow bg-slate-800\">\r\n        <h3 class=\"text-xl font-bold\">Join Room</h3>\r\n        <br class=\"block border border-indigo-600\">\r\n        <form [formGroup]=\"joinRoomForm\" (submit)=\"joinRoomSubmit()\" class=\"flex flex-col gap-3\">\r\n          <input formControlName=\"username\" type=\"text\" name=\"username\" id=\"username-field-create\"\r\n            placeholder=\"Enter username for room\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-slate-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600\">\r\n\r\n          <input formControlName=\"roomname\" type=\"text\" name=\"roomname\" id=\"roomname-field-create\"\r\n            placeholder=\"Enter name of room\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-slate-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600\">\r\n\r\n          <button type=\"submit\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-indigo-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600 hover:bg-indigo-600\">\r\n            Join Existing Room\r\n          </button>\r\n\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { NgStyle } from '@angular/common';\r\nimport { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { RemotePeersService } from 'src/app/services/remote-peers.service';\r\nimport { SignalingService } from 'src/app/services/signaling.service';\r\n\r\nexport interface Connection {\r\n  id: string | null;\r\n  conn: RTCPeerConnection;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-page-room',\r\n  templateUrl: './page-room.component.html',\r\n  styles: []\r\n})\r\nexport class PageRoomComponent implements OnInit {\r\n\r\n  servers = [\r\n    'stun:stun.l.google.com:19302',\r\n    'stun:stun1.l.google.com:19302',\r\n    'stun:stun2.l.google.com:19302',\r\n    'stun:stun3.l.google.com:19302',\r\n    'stun:stun4.l.google.com:19302',\r\n    'stun:stun.ekiga.net',\r\n    'stun:stun.ideasip.com',\r\n    'stun:stun.iptel.org',\r\n    'stun:stun.rixtelecom.se',\r\n    'stun:stun.schlund.de',\r\n    'stun:stunserver.org',\r\n    'stun:stun.softjoys.com',\r\n    'stun:stun.voiparound.com',\r\n    'stun:stun.voipbuster.com',\r\n    'stun:stun.voipstunt.com',\r\n  ]\r\n\r\n  roomName: string | null = null;\r\n  userName: string | null = null;\r\n  selfStream: BehaviorSubject<MediaStream | null> = new BehaviorSubject<MediaStream | null>(null);\r\n\r\n  remotes: Connection[] = [];\r\n\r\n\r\n  constructor(private peerService: RemotePeersService, private signalService: SignalingService) {\r\n    this.roomName = window.localStorage.getItem('roomname');\r\n    this.userName = window.localStorage.getItem('username');\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.getUserMedia()\r\n  }\r\n\r\n  async getUserMedia(): Promise<void> {\r\n    let mediaStream = await navigator.mediaDevices.getUserMedia({\r\n      audio: true,\r\n      video: {\r\n        width: { min: 320, ideal: 720, max: 1280 },\r\n        height: { min: 240, ideal: 540, max: 720 }\r\n      }\r\n    });\r\n    this.selfStream.next(mediaStream);\r\n    this.signalService.getMessageQueue().subscribe({\r\n      next: (msg) => {\r\n        console.log(msg);\r\n        switch (msg.type) {\r\n          case 'offer':\r\n            this.peerService.createStreamAnswer(this.remotes[0].conn, msg.data);\r\n            break;\r\n          case 'answer':\r\n            this.remotes[0].conn.setRemoteDescription(msg.data).then(() => {\r\n              this.selfStream.value?.getTracks().forEach(track => {\r\n                this.remotes[0].conn.addTrack(track);\r\n              });\r\n            });\r\n            break;\r\n          case 'candidate':\r\n            if (msg.data != null) {\r\n              let candidate = new RTCIceCandidate(msg.data);\r\n              this.remotes[0].conn.addIceCandidate(candidate);\r\n            }\r\n            break;\r\n          case 'text':\r\n            break;\r\n        }\r\n      }\r\n    });\r\n    let conn = await this.peerService.createStreamOffer(mediaStream);\r\n    this.remotes.push({ id: this.userName, conn });\r\n  }\r\n\r\n\r\n}\r\n","<div class=\"block min-h-screen w-full overflow-auto\">\r\n  <div class=\"flex flex-row items-center justify-between py-4 px-6 bg-indigo-700 shadow\">\r\n    <h1 class=\"text-xl font-medium\">Joined Room {{roomName}} as {{userName}}</h1>\r\n    <div class=\"flex flex-row gap-4\">\r\n      <!-- todo: Add Notifications -->\r\n    </div>\r\n  </div>\r\n  <app-video-preview [streamSource]=\"selfStream\"></app-video-preview>\r\n  <app-video-grid [connections]=\"remotes\"></app-video-grid>\r\n  <app-chat-component></app-chat-component>\r\n</div>\r\n","import { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\nimport { RemotePeersService } from 'src/app/services/remote-peers.service';\r\nimport { SignalingService } from 'src/app/services/signaling.service';\r\n\r\n@Component({\r\n  selector: 'app-page-single',\r\n  templateUrl: './page-single.component.html',\r\n  styleUrls: []\r\n})\r\nexport class PageSingleComponent implements OnInit {\r\n\r\n  @ViewChild('localVideo', { static: true }) localVideo !: ElementRef<HTMLVideoElement>;\r\n  @ViewChild('remoteVideo', { static: true }) remoteVideo !: ElementRef<HTMLVideoElement>;\r\n\r\n  localStream !: MediaStream;\r\n  connection !: RTCPeerConnection;\r\n\r\n  constructor(private peerConnection: RemotePeersService, private signal: SignalingService) { }\r\n\r\n  ngOnInit(): void {\r\n    if (this.connection == undefined) {\r\n      this.connection = this.peerConnection.createNewConnection();\r\n    }\r\n    this.signal.getMessageQueue().subscribe({\r\n      next: (msg) => {\r\n        switch (msg.type) {\r\n          case 'offer':\r\n            this.connection.ontrack = (e: RTCTrackEvent) => {\r\n              this.remoteVideo.nativeElement.srcObject = e.streams[0];\r\n            }\r\n            this.localStream.getTracks().forEach(track => {\r\n              this.connection.addTrack(track, this.localStream);\r\n            })\r\n            this.peerConnection.createAnswer(this.connection, msg.data);\r\n            break;\r\n          case 'answer':\r\n            this.connection.setRemoteDescription(msg.data).then(() => {\r\n            });\r\n            break;\r\n          case 'stream':\r\n            this.localStream.getTracks().forEach(track => {\r\n              this.connection.addTrack(track, this.localStream);\r\n            })\r\n            break;\r\n          case 'candidate':\r\n            if (msg.data != null) {\r\n              let candidate = new RTCIceCandidate(msg.data);\r\n              this.connection.addIceCandidate(candidate);\r\n            }\r\n            break;\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  async startMedia() {\r\n    this.localStream = await navigator.mediaDevices.getUserMedia({\r\n      audio: true, video: true\r\n    });\r\n    this.localVideo.nativeElement.srcObject = this.localStream;\r\n  }\r\n\r\n  async call() {\r\n    this.connection = await this.peerConnection.createNewConnection();\r\n    this.localStream.getTracks().forEach(track => {\r\n      this.connection.addTrack(track, this.localStream);\r\n      this.connection.ontrack = (e: RTCTrackEvent) => {\r\n        console.log(e.streams.length);\r\n        this.remoteVideo.nativeElement.srcObject = e.streams[0];\r\n      }\r\n    })\r\n    await this.peerConnection.createOffer(this.connection);\r\n  }\r\n\r\n  hangup() {\r\n\r\n  }\r\n\r\n}\r\n","<div class=\"flex flex-row\">\r\n  <div class=\"w-1/2\">\r\n    <video class=\"border border-slate-600 bg-slate-800 w-80 h-60\" #localVideo [controls]=\"true\" [autoplay]=\"true\"\r\n      [muted]=\"true\"></video>\r\n  </div>\r\n  <div class=\"w-1/2\">\r\n    <video class=\"border border-slate-600 bg-slate-800 w-80 h-60\" #remoteVideo [controls]=\"true\" [autoplay]=\"true\"\r\n      [muted]=\"true\"></video>\r\n  </div>\r\n</div>\r\n<div class=\"flex flex-row\">\r\n  <button (click)=\"startMedia()\" class=\"border border-indigo-600 bg-indigo-800 px-3 py-2\">Get Media</button>\r\n  <button (click)=\"call()\" class=\"border border-indigo-600 bg-indigo-800 px-3 py-2\">Call</button>\r\n  <button (click)=\"hangup()\" class=\"border border-indigo-600 bg-indigo-800 px-3 py-2\">Hangup</button>\r\n</div>\r\n","import { ElementRef, Injectable } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { SignalingService } from './signaling.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class RemotePeersService {\r\n\r\n  constructor(private signalService: SignalingService) { }\r\n\r\n  async createOffer(conn: RTCPeerConnection) {\r\n    let description = await conn.createOffer({ offerToReceiveAudio: true, offerToReceiveVideo: true });\r\n    await conn.setLocalDescription(description);\r\n    this.signalService.sendMessage({ type: 'offer', data: description });\r\n  }\r\n\r\n  async createAnswer(conn: RTCPeerConnection, offer: RTCSessionDescriptionInit) {\r\n    await conn.setRemoteDescription(new RTCSessionDescription(offer));\r\n    const answer = await conn.createAnswer({ offerToReceiveAudio: true, offerToReceiveVideo: true });\r\n    await conn.setLocalDescription(answer);\r\n    this.signalService.sendMessage({ type: 'answer', data: conn.localDescription });\r\n  }\r\n\r\n\r\n  async createStreamAnswer(conn: RTCPeerConnection, offerData: RTCSessionDescriptionInit): Promise<void> {\r\n    await conn.setRemoteDescription(offerData);\r\n    const desc: RTCSessionDescriptionInit = await conn.createAnswer();\r\n    await conn.setLocalDescription(desc);\r\n    this.signalService.sendMessage({ type: 'answer', data: conn.localDescription });\r\n  }\r\n\r\n  async createStreamOffer(stream: MediaStream): Promise<RTCPeerConnection> {\r\n    let conn = this.createNewConnection();\r\n    stream.getTracks().forEach(track => conn.addTrack(track, stream));\r\n    let desc = await conn.createOffer({ offerToReceiveAudio: true, offerToReceiveVideo: true });\r\n    await conn.setLocalDescription(desc);\r\n    this.signalService.sendMessage({ type: 'offer', data: desc });\r\n    return conn;\r\n  }\r\n\r\n  async establishConnection(conn: RTCPeerConnection, answerData: RTCSessionDescriptionInit, stream: MediaStream): Promise<void> {\r\n    await conn.setRemoteDescription(answerData);\r\n    stream.getTracks().forEach(track => {\r\n      conn.addTrack(track, stream);\r\n    })\r\n  }\r\n\r\n  createNewConnection() {\r\n    let conn = new RTCPeerConnection({\r\n      iceServers: [\r\n        {\r\n          urls: [\r\n            'stun:stun.l.google.com:19302',\r\n            'stun:stun1.l.google.com:19302',\r\n            'stun:stun2.l.google.com:19302',\r\n            'stun:stun3.l.google.com:19302',\r\n          ]\r\n        }\r\n      ]\r\n    });\r\n    conn.onicecandidate = (event: RTCPeerConnectionIceEvent) => {\r\n      console.info('Candidate Changed');\r\n      this.signalService.sendMessage({\r\n        type: 'candidate',\r\n        data: event.candidate\r\n      })\r\n    }\r\n    conn.onicegatheringstatechange = (event: Event) => {\r\n      switch (conn.iceConnectionState) {\r\n        case 'closed':\r\n        case 'disconnected':\r\n        case 'failed':\r\n          console.error('Failed to connect');\r\n          break;\r\n      }\r\n    }\r\n    conn.onsignalingstatechange = (event: Event) => {\r\n      console.info(event);\r\n      switch (conn.signalingState) {\r\n        case 'closed':\r\n          console.error('Connection Closed');\r\n          break;\r\n      }\r\n    }\r\n    return conn;\r\n  }\r\n\r\n\r\n  createConnectionObject(\r\n    onIceCandidateChange: (e: RTCPeerConnectionIceEvent) => void,\r\n    onConnectionStateChange: (e: Event) => void\r\n  ) {\r\n    let conn = new RTCPeerConnection({\r\n      iceServers: [\r\n        {\r\n          urls: [\r\n            'stun:stun.l.google.com:19302',\r\n            'stun:stun1.l.google.com:19302',\r\n            'stun:stun2.l.google.com:19302',\r\n            'stun:stun3.l.google.com:19302',\r\n          ]\r\n        }\r\n      ]\r\n    });\r\n    conn.onicecandidate = (event: RTCPeerConnectionIceEvent) => {\r\n      this.signalService.sendMessage({\r\n        type: 'candidate',\r\n        data: event.candidate\r\n      })\r\n      onIceCandidateChange(event);\r\n    }\r\n    conn.onicegatheringstatechange = (event: Event) => {\r\n      console.info(event);\r\n      switch (conn.iceConnectionState) {\r\n        case 'closed':\r\n        case 'disconnected':\r\n        case 'failed':\r\n          console.error('Failed to connect');\r\n          break;\r\n      }\r\n    }\r\n    conn.onsignalingstatechange = (event: Event) => {\r\n      onConnectionStateChange(event);\r\n      switch (conn.signalingState) {\r\n        case 'closed':\r\n          console.error('Connection Closed');\r\n          break;\r\n      }\r\n    }\r\n    return conn;\r\n  }\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable, Subject } from 'rxjs';\r\n\r\nexport interface Message {\r\n  type: string;\r\n  data: any;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SignalingService {\r\n\r\n  private messages = new Subject<any>();\r\n\r\n  socket !: WebSocket;\r\n  url = 'ws://192.168.5.27:8081/'\r\n\r\n  constructor() {\r\n    this.socket = new WebSocket(this.url);\r\n    this.socket.onopen = () => {\r\n      console.log('WebSocket connection open');\r\n    };\r\n    this.socket.onmessage = (message: any) => {\r\n      this.messages.next(JSON.parse(message.data));\r\n    }\r\n  }\r\n\r\n  sendMessage(message: any) {\r\n    this.socket.send(JSON.stringify(message));\r\n  }\r\n\r\n  getMessageQueue(): Observable<any> {\r\n    return this.messages.asObservable();\r\n  }\r\n\r\n}\r\n","import { Component, Input, OnInit } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { Signal, SignalService } from '../../services/signal.service';\r\n\r\n@Component({\r\n  selector: 'app-chat-box',\r\n  templateUrl: './chat-box.component.html',\r\n  styleUrls: []\r\n})\r\nexport class ChatBoxComponent implements OnInit {\r\n\r\n  @Input() username = '';\r\n\r\n  chatMessage: string = '';\r\n\r\n  messages = new BehaviorSubject<any[]>([]);\r\n\r\n  constructor(private signal: SignalService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.signal.getMessages().subscribe({\r\n      next: (msg) => {\r\n        switch (msg.type) {\r\n          case Signal.Text:\r\n            let msgs = this.messages.value;\r\n            msgs.push(msg.data);\r\n            this.messages.next(msgs);\r\n        }\r\n\r\n      }\r\n    });\r\n  }\r\n\r\n  sendMessage() {\r\n    this.signal.sendSignal(Signal.Text, { from: this.username, msg: this.chatMessage });\r\n    this.chatMessage = '';\r\n  }\r\n\r\n}\r\n","<div class=\"flex flex-col w-64 bg-slate-600 px-3 py-2\">\r\n  <div>\r\n    <ng-container *ngFor=\"let message of messages|async\">\r\n      <div class=\"py-2 px-3\">\r\n        <span class=\"block w-full\">{{message.msg}}</span>\r\n        <span class=\"block w-full text-xs text-right italic\">{{message.from}}</span>\r\n      </div>\r\n    </ng-container>\r\n\r\n  </div>\r\n  <div class=\"flex\">\r\n    <input title=\"Chat Message\" placeholder=\"Enter Message Here...\" type=\"text\" [(ngModel)]=\"chatMessage\"\r\n      class=\"appearance-none outline-none rounded border px-3 py-2 transition-all duration-200 ease-out border-slate-700 bg-slate-800 focus:ring focus:border-indigo-600 focus:ring-indigo-600/50\">\r\n    <button (click)=\"sendMessage()\" class=\"outline-none appearance-none focus:ring shadow rounded-full p-2 \">\r\n      <span class=\"sr-only\">Video Toggle</span>\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\"\r\n        class=\"w-6 h-6\">\r\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\"\r\n          d=\"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5\" />\r\n      </svg>\r\n\r\n    </button>\r\n  </div>\r\n</div>\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Component, Input, OnInit } from '@angular/core';\r\nimport { Signal, SignalService } from '../../services/signal.service';\r\n\r\n@Component({\r\n  selector: 'app-room-poll',\r\n  templateUrl: './room-poll.component.html',\r\n  styleUrls: ['./room-poll.component.scss']\r\n})\r\nexport class RoomPollComponent implements OnInit {\r\n\r\n  @Input() username: string = '';\r\n  @Input() roomname: string = '';\r\n\r\n  pollQuestion: string = '';\r\n  pollOption: string = '';\r\n\r\n  pollOptions: any[] = [];\r\n  pollResponses: any[] = [];\r\n\r\n\r\n  polls: any[] = [];\r\n\r\n  draftPoll: any = {\r\n    question: '',\r\n    options: []\r\n  };\r\n\r\n  constructor(private signal: SignalService, private http: HttpClient) { }\r\n\r\n  ngOnInit(): void {\r\n\r\n    this.preloadPolls();\r\n\r\n    this.signal.getMessages().subscribe({\r\n      next: (msg) => {\r\n        switch (msg.type) {\r\n          case Signal.PollQuery:\r\n            this.polls.push(msg.data);\r\n            console.info(msg);\r\n            break;\r\n          case Signal.PollResponse:\r\n            console.info(msg);\r\n            this.updateCount(msg.data);\r\n            break;\r\n          case Signal.PollOption:\r\n            console.info(msg);\r\n            break;\r\n        }\r\n\r\n      }\r\n    });\r\n  }\r\n\r\n  preloadPolls() {\r\n    const formData = new FormData();\r\n    formData.append('roomname', this.roomname);\r\n    this.http.post('api/poll/get', formData).subscribe({\r\n      next: (resp: any) => {\r\n        this.polls = resp;\r\n      }\r\n    })\r\n  }\r\n\r\n  createPollQuestion() {\r\n    this.draftPoll.question = this.pollQuestion;\r\n    // this.signal.sendSignal(Signal.PollQuery, { id: 'poll_' + Math.random() * 100000, owner: this.username, question: this.pollQuestion });\r\n  }\r\n\r\n  addPollOption() {\r\n    if (this.pollOption != '') {\r\n      this.draftPoll.options.push(this.pollOption);\r\n      this.pollOption = '';\r\n    }\r\n    // this.signal.sendSignal(Signal.PollOption, {})\r\n  }\r\n\r\n  postPoll() {\r\n    const formData = new FormData();\r\n    formData.append('username', this.username);\r\n    formData.append('roomname', this.roomname);\r\n    formData.append('question', this.draftPoll.question);\r\n    for (let option of this.draftPoll.options) {\r\n      formData.append('option', option);\r\n    }\r\n    this.http.post('api/poll/create', formData).subscribe({\r\n      next: (resp: any) => {\r\n        this.polls.push(resp);\r\n        this.signal.sendSignal(Signal.PollQuery, resp);\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n  sendResponse(poll: any, option: any) {\r\n    const formData = new FormData();\r\n    formData.append('option', option.id);\r\n    formData.append('respondee', this.username);\r\n    this.http.post('api/poll/respond', formData).subscribe({\r\n      next: (resp: any) => {\r\n        this.updateCount(resp);\r\n        this.signal.sendSignal(Signal.PollResponse, resp);\r\n      }\r\n    })\r\n  }\r\n\r\n  updateCount(resp: any) {\r\n    let poll = this.polls.find(poll => poll.id == resp.poll);\r\n    let option = poll.options.find((opt: any) => opt.id == resp.option);\r\n    option.count = resp.count;\r\n    console.info(this.polls);\r\n  }\r\n\r\n}\r\n","<div class=\"flex flex-col p-4 rounded bg-slate-700\">\r\n  <div *ngFor=\"let poll of polls\" class=\"flex flex-col\">\r\n    <h6 class=\"text-lg font-medium mb-4\">{{poll.question}}</h6>\r\n    <ng-container *ngFor=\"let option of poll.options\">\r\n      <a (click)=\"sendResponse(poll, option)\" class=\"px-3 py-2\">{{option.value}} {{option.count? option.count : 0}}</a>\r\n    </ng-container>\r\n  </div>\r\n\r\n  <div class=\"flex flex-col\">\r\n    <h6 class=\"text-lg font-medium mb-4\">{{draftPoll.question}}</h6>\r\n    <div class=\"flex flex-col border p-3\">\r\n      <ng-container *ngFor=\"let option of draftPoll.options\">\r\n        <a (click)=\"sendResponse(draftPoll, option)\" class=\"px-3 py-2 border-y\">{{option}}</a>\r\n      </ng-container>\r\n      <div class=\"flex gap-4\">\r\n        <input title=\"Chat Message\" placeholder=\"Enter Query Here...\" type=\"text\" [(ngModel)]=\"pollOption\"\r\n          class=\"appearance-none outline-none rounded border px-3 py-2 w-full transition-all duration-200 ease-out border-slate-700 bg-slate-800 focus:ring focus:border-indigo-600 focus:ring-indigo-600/50\">\r\n        <button (click)=\"addPollOption()\" class=\"outline-none appearance-none focus:ring shadow rounded-full p-2 \">\r\n          <span class=\"sr-only\">Video Toggle</span>\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\"\r\n            stroke=\"currentColor\" class=\"w-6 h-6\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\"\r\n              d=\"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5\" />\r\n          </svg>\r\n\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"flex gap-4\">\r\n    <input title=\"Chat Message\" placeholder=\"Enter Message Here...\" type=\"text\" [(ngModel)]=\"pollQuestion\"\r\n      class=\"appearance-none outline-none rounded border px-3 py-2 w-full transition-all duration-200 ease-out border-slate-700 bg-slate-800 focus:ring focus:border-indigo-600 focus:ring-indigo-600/50\">\r\n    <button (click)=\"createPollQuestion()\" class=\"outline-none appearance-none focus:ring shadow rounded-full p-2 \">\r\n      <span class=\"sr-only\">Video Toggle</span>\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\"\r\n        class=\"w-6 h-6\">\r\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\"\r\n          d=\"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5\" />\r\n      </svg>\r\n\r\n    </button>\r\n  </div>\r\n  <div class=\"p-3\">\r\n    <button (click)=\"postPoll()\" class=\"outline-none appearance-none focus:ring shadow rounded-full p-2 \">\r\n      Submit Poll\r\n    </button>\r\n  </div>\r\n</div>\r\n","import { AfterViewInit, Component, ElementRef, Input, OnInit, ViewChild } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-self-video',\r\n  templateUrl: './self-video.component.html',\r\n  styleUrls: []\r\n})\r\nexport class SelfVideoComponent implements OnInit, AfterViewInit {\r\n\r\n  @Input() username = 'Sample User Name';\r\n  @Input() source: BehaviorSubject<MediaStream | null> = new BehaviorSubject<MediaStream | null>(null);\r\n\r\n  @ViewChild('container', { static: true }) container !: ElementRef<HTMLDivElement>;\r\n  @ViewChild('preview', { static: true }) preview !: ElementRef<HTMLVideoElement>;\r\n\r\n  dragOffset = {\r\n    x: 0,\r\n    y: 0\r\n  };\r\n\r\n  videoEnabled = true;\r\n  audioEnabled = true;\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.container.nativeElement.ondragstart = (event) => {\r\n      event.stopImmediatePropagation();\r\n      this.dragOffset.x = event.offsetX;\r\n      this.dragOffset.y = event.offsetY;\r\n      this.preview.nativeElement.pause();\r\n    };\r\n    this.container.nativeElement.ondragend = (event) => {\r\n      event.stopImmediatePropagation();\r\n      this.preview.nativeElement.play();\r\n    };\r\n    this.container.nativeElement.ondrag = (event) => {\r\n      event.stopImmediatePropagation();\r\n      event.preventDefault();\r\n      if (event.screenX == 0 && event.screenY == 0) { return; }\r\n      this.container.nativeElement.style.top = `${event.clientY - this.dragOffset.y}px`;\r\n      this.container.nativeElement.style.right = `${window.innerWidth - event.clientX - this.dragOffset.x}px`;\r\n    };\r\n    this.source.subscribe({\r\n      next: (stream) => {\r\n        if (stream == null) {\r\n          return;\r\n        }\r\n        this.preview.nativeElement.srcObject = stream;\r\n\r\n        this.setVideoState();\r\n        this.setAudioState();\r\n      }\r\n    });\r\n  }\r\n\r\n  async setVideoState() {\r\n    if (this.source.value == null) {\r\n      return;\r\n    }\r\n    const mediaStream = this.source.value;\r\n    mediaStream?.getVideoTracks().forEach(track => {\r\n      track.enabled = this.videoEnabled;\r\n    });\r\n    if (mediaStream && mediaStream.getVideoTracks().length < 1 && this.videoEnabled == true) {\r\n      let newStream = await navigator.mediaDevices.getUserMedia({ video: true });\r\n      await newStream.getVideoTracks().forEach(track => mediaStream?.addTrack(track));\r\n      // this.source.next(newStream);\r\n    }\r\n  }\r\n\r\n  async setAudioState() {\r\n    if (this.source.value == null) {\r\n      return;\r\n    }\r\n    const mediaStream = this.source.value;\r\n    mediaStream?.getAudioTracks().forEach(track => {\r\n      track.enabled = this.audioEnabled;\r\n    });\r\n    if (mediaStream && mediaStream.getAudioTracks().length < 1 && this.audioEnabled == true) {\r\n      let newStream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n      await newStream.getAudioTracks().forEach(track => mediaStream?.addTrack(track));\r\n      // this.source.next(newStream);\r\n    }\r\n  }\r\n\r\n  toggleVideo(event: Event) {\r\n    this.videoEnabled = !this.videoEnabled;\r\n    this.setVideoState();\r\n  }\r\n\r\n  toggleAudio(event: Event) {\r\n    this.audioEnabled = !this.audioEnabled;\r\n    this.setAudioState();\r\n  }\r\n\r\n}\r\n","<div #container draggable=\"true\" style=\"top: 0px; right: 0px;\"\r\n  class=\"fixed z-50 w-80 h-60 shadow-lg border border-slate-700 bg-slate-800\">\r\n  <div class=\"relative block w-full h-full\">\r\n    <video #preview [autoplay]=\"true\"></video>\r\n    <div class=\"absolute top-3 left-3\">\r\n      <span class=\"font-medium text-lg\">{{username}}</span>\r\n    </div>\r\n    <div class=\"absolute flex flex-row gap-3 bottom-3 left-1/2 -translate-x-1/2\">\r\n      <button (click)=\"toggleVideo($event)\"\r\n        class=\"outline-none appearance-none focus:ring shadow rounded-full p-2 {{videoEnabled == true ? 'bg-slate-600/50 ring-slate-400' : 'bg-red-600 ring-red-400'}}\">\r\n        <span class=\"sr-only\">Video Toggle</span>\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\"\r\n          class=\"w-6 h-6\">\r\n          <path stroke-linecap=\"round\"\r\n            d=\"M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z\" />\r\n          3\r\n        </svg>\r\n      </button>\r\n      <button (click)=\"toggleAudio($event)\"\r\n        class=\"outline-none appearance-none focus:ring shadow rounded-full p-2 {{audioEnabled == true ? 'bg-slate-600/50 ring-slate-400' : 'bg-red-600 ring-red-400'}}\">\r\n        <span class=\"sr-only\">Audio Toggle</span>\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\"\r\n          class=\"w-6 h-6\">\r\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\"\r\n            d=\"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z\" />\r\n        </svg>\r\n\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-page-home',\r\n  templateUrl: './page-home.component.html',\r\n  styleUrls: []\r\n})\r\nexport class PageHomeComponent implements OnInit {\r\n\r\n  @ViewChild('createRoom') createRoom !: ElementRef<HTMLElement>;\r\n  @ViewChild('joinRoom') joinRoom !: ElementRef<HTMLElement>;\r\n\r\n  createRoomForm !: FormGroup;\r\n  joinRoomForm !: FormGroup;\r\n\r\n  constructor(private formBuilder: FormBuilder, private http: HttpClient, private router: Router) {\r\n    this.createRoomForm = this.formBuilder.group({\r\n      username: [null, [Validators.required]],\r\n      roomname: [null, [Validators.required]],\r\n    });\r\n    this.joinRoomForm = this.formBuilder.group({\r\n      username: [null, [Validators.required]],\r\n      roomname: [null, [Validators.required]],\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  toggleCreate(event: Event) {\r\n    event.preventDefault();\r\n    event.stopImmediatePropagation();\r\n    this.createRoom.nativeElement.classList.toggle('hidden');\r\n  }\r\n\r\n  dismissCreate(event: Event) {\r\n    event.preventDefault();\r\n    event.stopImmediatePropagation();\r\n    this.createRoom.nativeElement.classList.toggle('hidden');\r\n  }\r\n\r\n  createRoomSubmit() {\r\n    console.info(this.createRoomForm.valid, this.createRoomForm.value);\r\n    const formData = new FormData();\r\n    const jsonData = this.createRoomForm.value;\r\n    for (let item of Object.keys(jsonData)) {\r\n      formData.append(item, jsonData[item]);\r\n      console.log(item, jsonData[item]);\r\n    }\r\n    // this.navigateToLobby();\r\n    //todo: connect this to actual server\r\n    this.http.post('api/user/create', formData).subscribe({\r\n      next: (resp: any) => {\r\n        console.info(resp);\r\n        window.sessionStorage.setItem('session', JSON.stringify(resp));\r\n        this.navigateToLobby();\r\n      },\r\n      error: (err: any) => {\r\n        console.error(err);\r\n      }\r\n    })\r\n  }\r\n\r\n  toggleJoin(event: Event) {\r\n    event.preventDefault();\r\n    event.stopImmediatePropagation();\r\n    this.joinRoom.nativeElement.classList.toggle('hidden');\r\n  }\r\n\r\n  dismissJoin(event: Event) {\r\n    event.preventDefault();\r\n    event.stopImmediatePropagation();\r\n    this.joinRoom.nativeElement.classList.toggle('hidden');\r\n  }\r\n\r\n  joinRoomSubmit() {\r\n    console.info(this.joinRoomForm.valid, this.joinRoomForm.value);\r\n    const formData = new FormData();\r\n    const jsonData = this.joinRoomForm.value;\r\n    for (let item of Object.keys(jsonData)) {\r\n      formData.append(item, jsonData[item]);\r\n      console.log(item, jsonData[item]);\r\n    }\r\n    // this.navigateToLobby();\r\n    //todo: connect this to actual server\r\n    this.http.post('api/user/get', formData).subscribe({\r\n      next: (resp: any) => {\r\n        console.info(resp);\r\n        window.sessionStorage.setItem('session', JSON.stringify(resp));\r\n        this.navigateToLobby();\r\n      },\r\n      error: (err: any) => {\r\n        console.error(err);\r\n      }\r\n    })\r\n  }\r\n\r\n  navigateToLobby() {\r\n    this.router.navigate(['/', 'lobby']);\r\n  }\r\n\r\n  stopPropagation(event: Event) {\r\n    event.stopImmediatePropagation();\r\n  }\r\n\r\n}\r\n","<div class=\"block min-h-screen w-full overflow-auto\">\r\n  <div class=\"flex flex-row items-center py-4 px-6 bg-indigo-700 shadow\">\r\n    <h1 class=\"text-xl font-medium\">Conferencing</h1>\r\n  </div>\r\n  <div class=\"flex flex-col lg:flex-row\">\r\n    <div class=\"w-full lg:w-1/2\">\r\n      <div class=\"py-8 px-6 lg:py-16 lg:px-12\">\r\n        <h1 class=\"text-3xl lg:text-5xl font-bold\">\r\n          <span class=\"inline-block pb-4\">Easy Conferencing with</span>\r\n          <span class=\"inline-block text-indigo-600 pb-4\">Web RTC and django.</span>\r\n        </h1>\r\n        <p class=\"text-lg text-slate-300\">\r\n          It is as simple as implementing the room based broadcast mechanism. To get started,\r\n          simply add your email address and create a room.\r\n        </p>\r\n        <div class=\"flex flex-col lg:flex-row gap-4 pt-16\">\r\n          <button (click)=\"toggleCreate($event)\"\r\n            class=\"px-4 py-3 rounded border shadow transition-all duration-300 ease-in-out bg-indigo-600 border-indigo-700 hover:bg-indigo-500\">\r\n            Create Room\r\n          </button>\r\n          <button (click)=\"toggleJoin($event)\"\r\n            class=\"px-4 py-3 rounded border shadow transition-all duration-300 ease-in-out text-indigo-800 bg-indigo-300 border-indigo-400 hover:bg-indigo-400\">\r\n            Join Room\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"w-full lg:w-1/2\">\r\n    </div>\r\n  </div>\r\n\r\n  <div #createRoom (click)=\"dismissCreate($event)\" class=\"fixed hidden inset-0 bg-indigo-900/80\">\r\n    <div (click)=\"stopPropagation($event)\" class=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2\">\r\n      <div class=\"flex flex-col px-6 py-4 w-96 rounded shadow bg-slate-800\">\r\n        <h3 class=\"text-xl font-bold\">Create Room</h3>\r\n        <br class=\"block border border-indigo-600\">\r\n        <form [formGroup]=\"createRoomForm\" (submit)=\"createRoomSubmit()\" class=\"flex flex-col gap-3\">\r\n          <input formControlName=\"username\" type=\"text\" name=\"username\" id=\"username-field-create\"\r\n            placeholder=\"Enter username for room\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-slate-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600\">\r\n\r\n          <input formControlName=\"roomname\" type=\"text\" name=\"roomname\" id=\"roomname-field-create\"\r\n            placeholder=\"Enter name of room\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-slate-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600\">\r\n\r\n          <button type=\"submit\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-indigo-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600 hover:bg-indigo-600\">\r\n            Create and Enter Room\r\n          </button>\r\n\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div #joinRoom (click)=\"dismissJoin($event)\" class=\"fixed hidden inset-0 bg-indigo-900/80\">\r\n    <div (click)=\"stopPropagation($event)\" class=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2\">\r\n      <div class=\"flex flex-col px-6 py-4 w-96 rounded shadow bg-slate-800\">\r\n        <h3 class=\"text-xl font-bold\">Join Room</h3>\r\n        <br class=\"block border border-red-600\">\r\n        <form [formGroup]=\"joinRoomForm\" (submit)=\"joinRoomSubmit()\" class=\"flex flex-col gap-3\">\r\n          <input formControlName=\"username\" type=\"text\" name=\"username\" id=\"username-field-create\"\r\n            placeholder=\"Enter username for room\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-slate-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600\">\r\n\r\n          <input formControlName=\"roomname\" type=\"text\" name=\"roomname\" id=\"roomname-field-create\"\r\n            placeholder=\"Enter name of room\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-slate-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600\">\r\n\r\n          <button type=\"submit\"\r\n            class=\"rounded px-3 py-2 w-full outline-none appearance-none border transition-all duration-200 ease-in-out focus:ring border-slate-600 bg-indigo-700 text-slate-50 focus:border-indigo-60 focus:ring-indigo-600 hover:bg-indigo-600\">\r\n            Join Existing Room\r\n          </button>\r\n\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, ElementRef, OnInit, ViewChild, ɵɵsanitizeUrl } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-page-lobby',\r\n  templateUrl: './page-lobby.component.html',\r\n  styleUrls: []\r\n})\r\nexport class PageLobbyComponent implements OnInit {\r\n\r\n  @ViewChild('mediaPreview', { static: true }) mediaPreview !: ElementRef<HTMLVideoElement>;\r\n\r\n  mediaTracks = { audio: true, video: true };\r\n  mediaStream!: MediaStream;\r\n  session: any = null;\r\n\r\n  constructor(private router: Router) { }\r\n\r\n  ngOnInit(): void {\r\n    this.getMediaStream();\r\n    let rawData = window.sessionStorage.getItem('session');\r\n    if (rawData != null) {\r\n      this.session = JSON.parse(rawData);\r\n    }\r\n  }\r\n\r\n  async getMediaStream() {\r\n    this.mediaStream = await navigator.mediaDevices.getUserMedia(this.mediaTracks);\r\n    this.mediaPreview.nativeElement.srcObject = this.mediaStream;\r\n  }\r\n\r\n  async toggleVideo() {\r\n    this.mediaTracks.video = !this.mediaTracks.video;\r\n    await this.mediaStream.getVideoTracks().forEach(track => {\r\n      track.enabled = this.mediaTracks.video;\r\n    });\r\n  }\r\n  async toggleAudio() {\r\n    this.mediaTracks.audio = !this.mediaTracks.audio;\r\n    await this.mediaStream.getAudioTracks().forEach(track => {\r\n      track.enabled = this.mediaTracks.audio;\r\n    });\r\n  }\r\n\r\n  joinRoom() {\r\n    window.sessionStorage.setItem('mediaParam', JSON.stringify(this.mediaTracks));\r\n    this.mediaStream.getTracks().forEach(track => track.stop());\r\n    this.router.navigateByUrl('/room');\r\n  }\r\n\r\n  exitSession() {\r\n    this.mediaStream.getTracks().forEach(track => track.stop());\r\n    this.router.navigateByUrl('/');\r\n  }\r\n\r\n  shareLink() {\r\n    let room_url = `https://${window.location.host}/room/${this.session.roomname}`;\r\n    navigator.clipboard.writeText(room_url);\r\n  }\r\n\r\n}\r\n","<div class=\"block min-h-screen w-full overflow-auto\">\r\n  <div class=\"flex flex-row items-center py-4 px-6 bg-indigo-700 shadow\">\r\n    <h1 class=\"text-xl font-medium\">Conferencing</h1>\r\n  </div>\r\n  <div>\r\n    <div class=\"container p-6 lg:p-24\">\r\n      <div class=\"flex\">\r\n        <div class=\"relative flex justify-center w-9/12\">\r\n          <video #mediaPreview [autoplay]=\"true\" [muted]=\"mediaTracks.audio\"\r\n            class=\"border border-slate-600 bg-slate-800\" src=\"\"></video>\r\n          <div class=\"absolute left-1/2 bottom-6 -translate-x-1/2\">\r\n            <div class=\"flex gap-4\">\r\n              <button (click)=\"toggleVideo()\"\r\n                class=\"outline-none appearance-none focus:ring shadow rounded-full p-2 {{mediaTracks.video == true ? 'bg-slate-600/50 ring-slate-400' : 'bg-red-600 ring-red-400'}}\">\r\n                <span class=\"sr-only\">Toggle Video</span>\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\"\r\n                  stroke=\"currentColor\" class=\"w-6 h-6\">\r\n                  <path stroke-linecap=\"round\"\r\n                    d=\"M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z\" />\r\n                  3\r\n                </svg>\r\n              </button>\r\n              <button (click)=\"toggleAudio()\"\r\n                class=\"outline-none appearance-none focus:ring shadow rounded-full p-2 {{mediaTracks.audio == true ? 'bg-slate-600/50 ring-slate-400' : 'bg-red-600 ring-red-400'}}\">\r\n                <span class=\"sr-only\">Toggle Audio</span>\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\"\r\n                  stroke=\"currentColor\" class=\"w-6 h-6\">\r\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\"\r\n                    d=\"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z\" />\r\n                </svg>\r\n\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"w-3/12\">\r\n          <div class=\"flex flex-col gap-5\">\r\n\r\n            <h3 class=\"w-full text-2xl font-medium\">\r\n              Connect to '{{session?.roomname}}' as '{{session?.username}}' ?\r\n            </h3>\r\n            <a role=\"button\" (click)=\"joinRoom()\"\r\n              class=\"text-lg font-medium text-center px-3 py-2 rounded transition-all duration-300 ease-in-out hover:ring ring-indigo-600 bg-slate-800 hover:bg-indigo-700\">Join\r\n              Room</a>\r\n            <a role=\"button\" (click)=\"exitSession()\"\r\n              class=\"text-lg font-medium text-center px-3 py-2 rounded transition-all duration-300 ease-in-out hover:ring ring-indigo-600 bg-slate-800 hover:bg-indigo-700\">Exit\r\n              Session</a>\r\n            <a role=\"button\" (click)=\"shareLink()\"\r\n              class=\"text-lg font-medium text-center px-3 py-2 rounded transition-all duration-300 ease-in-out hover:ring ring-indigo-600 bg-slate-800 hover:bg-indigo-700\">Share\r\n              Link</a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, ComponentRef, ElementRef, OnInit, ViewChild, ViewContainerRef } from '@angular/core';\r\nimport { BehaviorSubject, find } from 'rxjs';\r\nimport { VideoCardComponent } from 'src/app/components/video-card/video-card.component';\r\nimport { PeerService } from '../../services/peer.service';\r\nimport { Signal, SignalService } from '../../services/signal.service';\r\n\r\n@Component({\r\n  selector: 'app-page-room',\r\n  templateUrl: './page-room.component.html',\r\n  styleUrls: []\r\n})\r\nexport class PageRoomComponent implements OnInit {\r\n  session: any = null;\r\n  peers: Map<string, RTCPeerConnection | null> = new Map();\r\n  @ViewChild('peerContainer', { read: ViewContainerRef }) peerContainer !: ViewContainerRef;\r\n\r\n  localMedia: MediaStream | null = null;\r\n  localStream = new BehaviorSubject<MediaStream | null>(null);\r\n\r\n  constructor(private signal: SignalService, private peerService: PeerService) { }\r\n\r\n  ngOnInit(): void {\r\n    let sess = window.sessionStorage.getItem('session');\r\n    if (sess != null) {\r\n      this.session = JSON.parse(sess);\r\n    }\r\n    navigator.mediaDevices.getUserMedia({ audio: true, video: true }).then(\r\n      (media) => {\r\n        this.localMedia = media;\r\n        this.localStream.next(this.localMedia);\r\n        this.signal.getMessages().subscribe({\r\n          next: (msg) => {\r\n            this.handleSignals(msg);\r\n          }\r\n        });\r\n        this.signal.getStateChanges().subscribe({\r\n          next: (state: string) => {\r\n            if (state == 'open') {\r\n              this.signal.sendSignal(Signal.Announce, this.session);\r\n            }\r\n          }\r\n        });\r\n      });\r\n\r\n  }\r\n\r\n  async handleSignals(msg: any) {\r\n    if (msg == null) { return; }\r\n    switch (msg.type) {\r\n      case Signal.Announce:\r\n        console.info('Received announcement from', msg.data.username);\r\n        this.peers.set(msg.data.username, null);\r\n        this.sendConnectionOffer(msg.data);\r\n        break;\r\n      case Signal.Candidate:\r\n        console.info('Received candidate change from', msg.data.username);\r\n        this.handleCandidateUpdate(msg.data);\r\n        break;\r\n      case Signal.Offer:\r\n        console.info('Received offer from', msg.data.username);\r\n        this.sendConnectionAnswer(msg.data);\r\n        break;\r\n      case Signal.Answer:\r\n        console.info('Received answer from', msg.data.username);\r\n        this.handlePostAnswer(msg.data);\r\n        break;\r\n      // case Signal.Acknowledge:\r\n      //   console.info('Received acknowledgement', msg.data);\r\n      //   if (msg.data.b != this.session.username) {\r\n      //     return;\r\n      //   }\r\n      //   connection = this.peers.get(msg.data.a);\r\n      //   console.info(connection);\r\n      //   if (connection != null) {\r\n      //     this.peerService.attachStreams(connection, this.localMedia);\r\n      //   }\r\n      //   break;\r\n    }\r\n  }\r\n\r\n  async sendConnectionOffer(target: any) {\r\n    let connection = this.peerService.createConnection(this.session.username);\r\n    this.peers.set(target.username, connection);\r\n    console.info(this.peers);\r\n    await this.peerService.makeOffer(connection, this.session.username);\r\n  }\r\n\r\n  async sendConnectionAnswer(target: any) {\r\n    let connection = this.peers.get(target.username)\r\n    if (connection == undefined) {\r\n      connection = this.peerService.createConnection(this.session.username);\r\n      this.peers.set(target.username, connection);\r\n      console.warn('Connection not found for', target.username, this.peers);\r\n    }\r\n    await this.peerService.attachStreams(connection, this.localMedia);\r\n    await this.peerService.sendAnswer(connection, target.desc, target.username);\r\n    connection.ontrack = (evt: RTCTrackEvent) => {\r\n      console.info('Got track from');\r\n    }\r\n    this.signal.sendSignal(Signal.Acknowledge, { a: this.session.username, b: target.username });\r\n  }\r\n\r\n  async handlePostAnswer(target: any) {\r\n    let connection = this.peers.get(target.username)\r\n    if (connection == undefined) {\r\n      return;\r\n    }\r\n    connection.ontrack = (evt: RTCTrackEvent) => {\r\n      console.warn('Track Updated', evt);\r\n    }\r\n  }\r\n\r\n  async handleCandidateUpdate(target: any) {\r\n    let connection = this.peers.get(target.username);\r\n    if (connection == undefined) {\r\n      console.warn('Connection not found for', target.username, this.peers);\r\n      return;\r\n    }\r\n    console.log(target);\r\n    await this.peerService.updateCandidates(connection, target.candidate);\r\n  }\r\n\r\n}\r\n","<!-- <app-self-video [username]=\"session.username\" [source]=\"localStream\"></app-self-video> -->\r\n<div class=\"absolute right-0 bottom-0\">\r\n</div>\r\n<div class=\"grid grid-cols-4 grid-flow-row-dense gap-3\">\r\n  <ng-container #peerContainer></ng-container>\r\n</div>\r\n<!-- <app-chat-box [username]=\"session.username\"></app-chat-box> -->\r\n<app-room-poll [username]=\"session.username\" [roomname]=\"session.roomname\"></app-room-poll>\r\n<ng-template #peerStream let-stream=\"stream\">\r\n  <div class=\"col-span-1 w-full h-full\">\r\n    <video [srcObject]=\"stream\" [autoplay]=\"true\" [muted]=\"true\"></video>\r\n  </div>\r\n</ng-template>\r\n","import { Injectable } from '@angular/core';\r\nimport { Signal, SignalService } from './signal.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class PeerService {\r\n\r\n  local !: RTCPeerConnection;\r\n  stream !: MediaStream;\r\n\r\n  constructor(private signal: SignalService) {\r\n    // this.local = this.createConnection();\r\n    // this.signal.getMessages().subscribe({\r\n    //   next: this.handleSignals\r\n    // });\r\n  }\r\n\r\n  setStream(stream: MediaStream) {\r\n    this.stream = stream;\r\n  }\r\n\r\n  handleSignals(msgs: any) {\r\n    // switch (msgs.type) {\r\n    //   case Signal.Offer:\r\n    //     this.sendAnswer(this.local, msgs.data);\r\n    //     break;\r\n    //   case Signal.Answer:\r\n    //     this.attachStreams(this.local, this.stream);\r\n    //     break;\r\n    //   case Signal.Acknowledge:\r\n    //     break;\r\n    // }\r\n  }\r\n\r\n  createConnection(target: string | null) {\r\n    let connection = new RTCPeerConnection();\r\n    connection.onicecandidate = (ev: RTCPeerConnectionIceEvent) => {\r\n      console.info('');\r\n      this.signal.sendSignal(Signal.Candidate, { candidate: ev.candidate?.toJSON(), username: target });\r\n    }\r\n    connection.onconnectionstatechange = (ev: Event) => {\r\n      console.warn('Connection state changed to', connection.connectionState);\r\n    }\r\n    return connection;\r\n  }\r\n\r\n  async makeOffer(connection: RTCPeerConnection | null = null, id: string | null = null) {\r\n    if (connection == null) {\r\n      connection = this.createConnection(id);\r\n    }\r\n    let description = await connection.createOffer({ offerToReceiveAudio: true, offerToReceiveVideo: true });\r\n    await connection.setLocalDescription(description);\r\n    this.signal.sendSignal(Signal.Offer, { desc: connection.localDescription?.toJSON(), username: id });\r\n  }\r\n\r\n  async sendAnswer(connection: RTCPeerConnection, offer: RTCSessionDescriptionInit, id: string | null) {\r\n    // console.log(connection, offer, id)\r\n    await connection.setRemoteDescription(new RTCSessionDescription(offer));\r\n    let answer = await connection.createAnswer();\r\n    await connection.setLocalDescription(answer);\r\n    this.signal.sendSignal(Signal.Answer, { desc: answer, username: id });\r\n  }\r\n\r\n  async attachStreams(connection: RTCPeerConnection, stream: MediaStream | null) {\r\n    if (stream == null) {\r\n      return;\r\n    }\r\n    stream.getTracks().forEach((track) => { connection.addTrack(track) });\r\n    // console.log(connection);\r\n    // if (connection.connectionState == 'connected') {\r\n    //   stream.getTracks().forEach(track => connection.addTrack(track));\r\n    // } else {\r\n    //   connection.onconnectionstatechange = (ev: Event) => {\r\n    //     // console.log(ev.currentTarget, connection.connectionState);\r\n    //     if (connection.connectionState == 'connected') {\r\n    //       stream.getTracks().forEach(\r\n    //         track => connection.addTrack(track)\r\n    //       );\r\n    //     }\r\n    //   }\r\n    // }\r\n  }\r\n\r\n  async updateCandidates(connection: RTCPeerConnection, candidate: any) {\r\n    if (connection.remoteDescription == null) {\r\n      console.log('Remote Description null');\r\n      return;\r\n    }\r\n    if (candidate == null) { return; }\r\n    // console.log('Adding candidate: ', connection, candidate);\r\n    await connection.addIceCandidate(new RTCIceCandidate(candidate));\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\nexport enum Signal {\r\n  Offer, Answer, Candidate, Acknowledge, Announce, Leave, Text, PollQuery, PollOption, PollResponse\r\n}\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SignalService {\r\n\r\n  private connection !: WebSocket;\r\n  private stateChange = new BehaviorSubject<string>('inactive');\r\n  private messages = new BehaviorSubject<any>(null);\r\n\r\n  constructor() {\r\n    this.connect();\r\n  }\r\n\r\n  connect(host: string = '192.168.5.27:8081', room: string = 'common') {\r\n    this.connection = new WebSocket(`ws://${host}/${room}/`);\r\n    this.connection.onopen = (event: Event) => { this.onConnectionStateChanged('open', event); }\r\n    this.connection.onclose = (event: CloseEvent) => { this.onConnectionStateChanged('close', event); }\r\n    this.connection.onerror = (event: Event) => { this.onConnectionStateChanged('error', event); }\r\n    this.connection.onmessage = (event: MessageEvent) => { this.onMessageReceived('message', event); }\r\n  }\r\n\r\n  getStateChanges() {\r\n    return this.stateChange.asObservable();\r\n  }\r\n\r\n  getMessages() {\r\n    return this.messages.asObservable();\r\n  }\r\n\r\n  sendSignal(type: Signal, data: any, recipient: string | null = null) {\r\n    const signalData = {\r\n      type: type,\r\n      data: data\r\n    };\r\n    this.sendJson(signalData, recipient);\r\n  }\r\n\r\n  sendJson(data: any, recipient: string | null = null) {\r\n    try {\r\n      this.sendString(data, recipient);\r\n    } catch (exception) {\r\n      console.error(exception);\r\n      throw exception;\r\n    }\r\n  }\r\n\r\n  sendBinary(data: any, recipient: string | null = null) {\r\n    try {\r\n      this.connection.send(data);\r\n    } catch (exception) {\r\n      console.error(exception);\r\n    }\r\n  }\r\n\r\n  sendString(data: string, recipient: string | null = null) {\r\n    try {\r\n      const stringdata = JSON.stringify({ payload: data, recipient: recipient });\r\n      this.sendBinary(stringdata, recipient);\r\n    } catch (exception) {\r\n      console.error(exception);\r\n    }\r\n  }\r\n\r\n  private onMessageReceived(state: string, event: MessageEvent) {\r\n    this.messages.next(JSON.parse(event.data).payload);\r\n  }\r\n\r\n  private onConnectionStateChanged(state: string, event: Event) {\r\n    this.stateChange.next(state);\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { PageHomeComponent } from './pages/page-home/page-home.component';\r\nimport { PageLobbyComponent } from './pages/page-lobby/page-lobby.component';\r\nimport { PageRoomComponent } from './pages/page-room/page-room.component';\r\n\r\nconst routes: Routes = [\r\n  { path: '', component: PageHomeComponent },\r\n  { path: 'lobby', component: PageLobbyComponent },\r\n  { path: 'room', component: PageRoomComponent }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class WebrtcRoutingModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { PageHomeComponent } from './pages/page-home/page-home.component';\r\nimport { PageLobbyComponent } from './pages/page-lobby/page-lobby.component';\r\nimport { PageRoomComponent } from './pages/page-room/page-room.component';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { WebrtcRoutingModule } from './webrtc-routing.module';\r\nimport { SelfVideoComponent } from './components/self-video/self-video.component';\r\nimport { ChatBoxComponent } from './components/chat-box/chat-box.component';\r\nimport { RoomPollComponent } from './components/room-poll/room-poll.component';\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    PageHomeComponent,\r\n    PageLobbyComponent,\r\n    PageRoomComponent,\r\n    SelfVideoComponent,\r\n    ChatBoxComponent,\r\n    RoomPollComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    WebrtcRoutingModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    HttpClientModule\r\n  ]\r\n})\r\nexport class WebrtcModule { }\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false\r\n};\r\n\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/plugins/zone-error';  // Included with Angular CLI.\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n"],"names":["BehaviorSubject","i0","ChatComponentComponent","constructor","signalService","ngOnInit","getMessageQueue","subscribe","next","msg","console","info","selectors","decls","vars","consts","template","PageRoomComponent","peerService","roomName","window","localStorage","getItem","userName","getUserMedia","mediaStream","navigator","mediaDevices","audio","video","width","min","ideal","max","height","selfStream","log","type","createStreamAnswer","remotes","conn","data","setRemoteDescription","then","value","getTracks","forEach","track","addTrack","candidate","RTCIceCandidate","addIceCandidate","createStreamOffer","push","id","ElementRef","PageSingleComponent","peerConnection","signal","connection","undefined","createNewConnection","ontrack","e","remoteVideo","nativeElement","srcObject","streams","localStream","createAnswer","startMedia","localVideo","call","length","createOffer","hangup","viewQuery","ctx","RemotePeersService","description","offerToReceiveAudio","offerToReceiveVideo","setLocalDescription","sendMessage","offer","RTCSessionDescription","answer","localDescription","offerData","desc","stream","establishConnection","answerData","RTCPeerConnection","iceServers","urls","onicecandidate","event","onicegatheringstatechange","iceConnectionState","error","onsignalingstatechange","signalingState","createConnectionObject","onIceCandidateChange","onConnectionStateChange","factory","providedIn","Signal","ChatBoxComponent","getMessages","Text","msgs","messages","sendSignal","from","username","chatMessage","inputs","SelfVideoComponent","x","y","ngAfterViewInit","container","ondragstart","stopImmediatePropagation","dragOffset","offsetX","offsetY","preview","pause","ondragend","play","ondrag","preventDefault","screenX","screenY","style","top","clientY","right","innerWidth","clientX","source","setVideoState","setAudioState","getVideoTracks","enabled","videoEnabled","newStream","getAudioTracks","audioEnabled","toggleVideo","toggleAudio","PageLobbyComponent","router","getMediaStream","rawData","sessionStorage","session","JSON","parse","mediaTracks","mediaPreview","joinRoom","setItem","stringify","stop","navigateByUrl","exitSession","shareLink","room_url","location","host","roomname","clipboard","writeText","ViewContainerRef","Map","sess","media","localMedia","handleSignals","getStateChanges","state","Announce","peers","set","sendConnectionOffer","Candidate","handleCandidateUpdate","Offer","sendConnectionAnswer","Answer","handlePostAnswer","target","createConnection","makeOffer","get","warn","attachStreams","sendAnswer","evt","Acknowledge","a","b","updateCandidates","PeerService","setStream","ev","toJSON","onconnectionstatechange","connectionState","remoteDescription"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}